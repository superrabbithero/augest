"use strict";(self["webpackChunkaugest"]=self["webpackChunkaugest"]||[]).push([[8085],{5939:function(e,t,a){a.r(t),a.d(t,{default:function(){return q}});var n=a(9812),s=a(5893),i=a(4220);const l={class:"line-content-center"},o=(0,n._)("label",null,"日期：",-1),r={class:"line-content-center"},d=(0,n._)("label",null,"期限：",-1),m={class:"line-content-center"},g={class:"repeat-list"},c=["value"],u={class:"line-content-center"},h={class:"line-content-center"},p=(0,n._)("label",null,"紧急",-1),D=(0,n._)("label",null,"重要",-1),f={class:"line-content-center left"},w={class:"card-content main-content",style:{"text-align":"left"},ref:"fqtMain"},v={class:"calendar-list"},M=["onClick"],y={key:0,class:"date"},k={key:1,class:"date"},b={key:2,class:"date"},C={key:3,class:"date"},x=["id"],_=["onClick"],N=["onPointerdown"],W=["id"],L={class:"list-item",style:{display:"flex","justify-content":"center"}},I={class:"axes x"},$=(0,n._)("div",{style:{"background-color":"#F96635"}},"重要",-1),F=[$],U={class:"axes y"},E=(0,n._)("div",{style:{"background-color":"#f9A822"}},"紧急",-1),T=[E];function Y(e,t,a,$,E,Y){const z=(0,n.up)("calender"),S=(0,n.up)("svg-icon"),P=(0,n.up)("my-model");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(P,{show:E.modal_show.addPlanShow,modalKey:"addPlanShow",modeless:!1},{default:(0,n.w5)((()=>[(0,n._)("div",l,[o,(0,n.Wm)(z,{language:"EN",type:"input",style:{width:"150px"},class:"form-input",modelValue:E.management.date,"onUpdate:modelValue":t[0]||(t[0]=e=>E.management.date=e)},null,8,["modelValue"]),(0,n.Wm)(S,{class:(0,s.C_)({"text-button":!0,action:Y.compareDate(E.management.date)}),name:"today",size:"16",onClick:t[1]||(t[1]=e=>Y.getManagementDate())},null,8,["class"]),(0,n.Wm)(S,{class:(0,s.C_)({"text-button":!0,action:Y.compareDate(E.management.date,1)}),name:"tomorrow",size:"16",onClick:t[2]||(t[2]=e=>Y.getManagementDate(1))},null,8,["class"])]),(0,n._)("div",r,[d,(0,n.Wm)(z,{language:"EN",type:"datetime",style:{width:"150px"},class:"form-input",modelValue:E.management.deadline,"onUpdate:modelValue":t[3]||(t[3]=e=>E.management.deadline=e)},null,8,["modelValue"]),(0,n.Wm)(S,{class:"text-button",name:"delete02",size:"16",onClick:t[4]||(t[4]=e=>E.management.deadline=null)})]),(0,n._)("div",m,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(E.repeatLabelList,(e=>((0,n.wg)(),(0,n.iD)("div",g,[(0,n.wy)((0,n._)("input",{class:"form-input",type:"radio",name:"repeat",value:e.value,"onUpdate:modelValue":t[5]||(t[5]=e=>E.management.repeat=e)},null,8,c),[[i.G2,E.management.repeat]]),(0,n._)("label",{class:(0,s.C_)({selected:e.value==E.management.repeat})},(0,s.zw)(e.label),3)])))),256))]),(0,n._)("div",u,[(0,n.wy)((0,n._)("textarea",{placeholder:"做什么呢...",rows:"5","onUpdate:modelValue":t[6]||(t[6]=e=>E.management.content=e)},null,512),[[i.nr,E.management.content]])]),(0,n._)("div",h,[p,(0,n.wy)((0,n._)("input",{type:"checkbox",class:"circle form-input","onUpdate:modelValue":t[7]||(t[7]=e=>E.management.urgent=e),checked:""},null,512),[[i.e8,E.management.urgent]]),D,(0,n.wy)((0,n._)("input",{type:"checkbox",class:"circle form-input","onUpdate:modelValue":t[8]||(t[8]=e=>E.management.important=e)},null,512),[[i.e8,E.management.important]])]),(0,n._)("div",f,[(0,n._)("button",{class:"fill",onClick:t[9]||(t[9]=e=>Y.addManagement())},(0,s.zw)(E.updateIndex?"修改计划":"新增计划"),1)])])),_:1},8,["show"]),(0,n._)("div",w,[(0,n._)("div",v,[(0,n.Wm)(S,{name:"arrow-left",className:"date-item",onClick:Y.preWeek},null,8,["onClick"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(E.currentWeek,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,class:"date-item",onClick:t=>Y.toDate(Y.getFormattedDate(e))},[Y.getFormattedDate(e)==Y.getFormattedDate(E.today)?((0,n.wg)(),(0,n.iD)("div",y,[(0,n.Wm)(S,{name:"today"})])):Y.getFormattedDate(e)==Y.getFormattedDate(E.today,1)?((0,n.wg)(),(0,n.iD)("div",k,[(0,n.Wm)(S,{name:"tomorrow"})])):Y.getFormattedDate(e)==Y.getFormattedDate(E.today,-1)?((0,n.wg)(),(0,n.iD)("div",b,[(0,n.Wm)(S,{name:"yesterday"})])):((0,n.wg)(),(0,n.iD)("div",C,(0,s.zw)(e.getDate()),1))],8,M)))),128)),(0,n.Wm)(S,{name:"arrow-right",className:"date-item",onClick:Y.nextWeek},null,8,["onClick"]),(0,n.Wm)(S,{name:"letter-plus01",className:"date-item",onClick:t[10]||(t[10]=e=>Y.showAddPlan())}),(0,n.Wm)(S,{name:"refresh02",class:"update-icon",className:"date-item",onClick:t[11]||(t[11]=e=>Y.getCurManagementData(E.currentDate))}),(0,n.Wm)(S,{name:"upload01",className:"date-item",onClick:Y.saveJson},null,8,["onClick"])]),(0,n.Uk)(" "+(0,s.zw)(E.currentDate)+" ",1),(0,n._)("div",{class:(0,s.C_)({"quadrant-container":!0,draging:E.draged})},[(0,n.wy)((0,n._)("div",{class:(0,s.C_)(Y.dragedManagementClass),ref:"dragedManagement"},[(0,n.Wm)(S,{name:"dot01",size:"16",className:"dot",style:(0,s.j5)(Y.dragedDotColor)},null,8,["style"]),(0,n.Uk)(" "+(0,s.zw)(E.dragedManagement?E.dragedManagement.content:""),1)],2),[[i.F8,E.draged]]),((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)(4,(e=>(0,n._)("div",{class:"quadrant-box",id:`quadrantList${e}`},[(0,n._)("div",{class:(0,s.C_)(["quadrant-list"]),onClick:t=>Y.showAddPlan(e)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(E.currentManagementList[e-1],(a=>((0,n.wg)(),(0,n.iD)("div",{class:(0,s.C_)(["list-item","item-"+(e-1)]),onClick:t[14]||(t[14]=(0,i.iM)((()=>{}),["stop"])),onPointerdown:e=>Y.listItemDown(e,a)},[(0,n._)("div",{class:"content",style:(0,s.j5)({textDecoration:Y.itemFinished(a)?"line-through":"none"})},[(0,n.Wm)(S,{name:"dot01",size:"16",className:"dot",style:(0,s.j5)({color:E.fourColors[e-1]})},null,8,["style"]),(0,n.Uk)(" "+(0,s.zw)(a.content),1)],4),(0,n._)("div",{id:`planIndex${a.index}`,class:"line-content-center"},[(0,n.Wm)(S,{name:"flag01",size:"16",className:"dot",style:(0,s.j5)({color:E.fourColors[e-1]}),onClick:[t[12]||(t[12]=(0,i.iM)((()=>{}),["stop"])),e=>Y.finishItem(a)]},null,8,["style","onClick"]),(0,n.Wm)(S,{name:"delete02",size:"16",className:"dot",style:(0,s.j5)({color:E.fourColors[e-1]}),onClick:[t[13]||(t[13]=(0,i.iM)((()=>{}),["stop"])),e=>Y.deleteItem(a)]},null,8,["style","onClick"])],8,W)],42,N)))),256)),(0,n.wy)((0,n._)("div",L,[(0,n._)("div",{class:(0,s.C_)(["list-add-button-"+(e-1)])},"+",2)],512),[[i.F8,!1]])],8,_)],8,x))),64)),(0,n.wy)((0,n._)("div",I,F,512),[[i.F8,!0]]),(0,n.wy)((0,n._)("div",U,T,512),[[i.F8,!0]])],2)],512)],64)}a(7658);var z=a(5570),S=a(8316),P=a(3438),j={computed:{compareDate(){return(e,t=0)=>{if(e){const a=e.split("/"),n=new Date(Number(a[0]),Number(a[1])-1,Number(a[2])),s=new Date;return s.setDate(s.getDate()+t),`${n.getYear()}${n.getMonth()}${n.getDate()}`==`${s.getYear()}${s.getMonth()}${s.getDate()}`}return!1}},dragedManagementClass(){let e={"list-item":!0,draged:this.draged};const t=[2,0,3,1];if(this.dragedManagement){const a=this.dragedManagement.urgent?1:0,n=this.dragedManagement.important?1:0,s=t[2*n+a],i=`item-${s}`;e[i]=!0}return e},dragedDotColor(){const e=[2,0,3,1];if(this.dragedManagement){const t=this.dragedManagement.urgent?1:0,a=this.dragedManagement.important?1:0,n=e[2*a+t];return{color:this.fourColors[n]}}},itemFinished(){return e=>e.finishedDate.includes(this.currentDate)}},components:{calender:z.Z},data(){return{fourColors:["#f9A822","#F96635","#2bbaa5","#93d3a2"],repeatLabelList:[{value:0,label:"不重复"},{value:1,label:"每天"},{value:7,label:"每周"},{value:30,label:"每月"},{value:-1,label:"每年"},{value:-2,label:"艾宾浩斯"}],currentWeek:[],today:null,currentDate:null,currentManagementList:[[],[],[],[]],modal_show:{addPlanShow:!1},management:{date:null,deadline:null,repeat:0,content:"",urgent:!1,important:!1,repeatDate:[],finishedDate:[]},managementList:[],updateIndex:null,dragedManagement:null,draged:!1,drag2Index:null,pressTimer:null,disx:null,disy:null,ifNeedSave:!1}},mounted(){this.fetchJson(),console.log(this.managementList),this.getWeekDate(),this.toDate(this.getFormattedDate(this.today)),window.addEventListener("beforeunload",this.handleBeforeUnload)},unmounted(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},methods:{listItemDown(e,t){const a=`planIndex${t.index}`,n=document.getElementById(a);n.contains(e.target)||(document.addEventListener("pointerup",this.listItemUp),document.addEventListener("pointermove",this.listItemMove),this.dragedManagement=t,this.pressTimer=setTimeout((()=>{this.draged=!0;const t=e.target;this.disx=e.pageX-t.offsetLeft,this.disy=e.pageY-t.offsetTop;const a=this.$refs.dragedManagement;a.style.left=e.pageX-this.disx+"px",a.style.top=e.pageY-this.disy+"px",clearTimeout(this.pressTimer),this.pressTimer=null}),500))},listItemMove(){if(this.draged){const e=document.getElementById("quadrantList4").getBoundingClientRect(),t=e.left,a=e.top;let n=4;event.clientX<t?n=event.clientY<a?1:3:event.clientY<a&&(n=2),this.drag2Index=n;const s=this.$refs.dragedManagement;s.style.left=event.pageX-this.disx+"px",s.style.top=event.pageY-this.disy+"px"}},listItemUp(e){if(this.pressTimer&&(clearTimeout(this.pressTimer),this.showAddPlan(this.dragedManagement),this.updateIndex=this.dragedManagement.index,this.dragedManagement=null),null!=this.dragedManagement){switch(this.drag2Index){case 1:this.dragedManagement.urgent=!0,this.dragedManagement.important=!1;break;case 2:this.dragedManagement.urgent=!0,this.dragedManagement.important=!0;break;case 3:this.dragedManagement.urgent=!1,this.dragedManagement.important=!1;break;case 4:this.dragedManagement.urgent=!1,this.dragedManagement.important=!0;break}this.updateManagement(this.dragedManagement)}this.draged=!1,this.dragedManagement=null,this.drag2Index=null,this.getCurManagementData(this.currentDate),document.removeEventListener("pointerup",this.listItemUp),document.removeEventListener("pointermove",this.listItemMove)},deleteItem(e){this.deleteManagement(e),this.getCurManagementData(this.currentDate)},finishItem(e){let t=null;e.finishedDate.forEach(((e,a)=>{this.currentDate!=e||(t=a)})),console.log(t),null==t?e.finishedDate.push(this.currentDate):e.finishedDate.splice(t,1),this.updateManagement(e),this.getCurManagementData(this.currentDate)},updateManagement(e){const t=e.index;delete e.index,this.managementList[t]=e,this.ifNeedSave=!0},deleteManagement(e){const t=e.index;this.managementList.splice(t,1),this.ifNeedSave=!0},toDate(e){this.getCurManagementData(e),this.currentDate=e},compare2Date(e,t){const a=new Date(e.split("T")[0]),n=new Date(t.split("T")[0]),s=a.getTime(),i=n.getTime();return s<i?-1:s>i?1:0},daysBetween(e,t){let a=e.split("/");const n=new Date(Number(a[0]),Number(a[1])-1,Number(a[2]));a=t.split("/");const s=new Date(Number(a[0]),Number(a[1])-1,Number(a[2])),i=864e5;return Math.round(Math.abs((n-s)/i))},getCurManagementData(e){this.currentManagementList=[[],[],[],[]],this.managementList.forEach(((t,a)=>{if(0==this.compare2Date(e,t.date))this.pushCurManagement(a,t);else if(1==this.compare2Date(e,t.date)){const n=Number(t.repeat);n>0&&this.daysBetween(e,t.date)%n==0?this.pushCurManagement(a,t):-1==n?e.split("/")[1]==t.date.split("/")[1]&&e.split("/")[2]==t.date.split("/")[2]&&this.pushCurManagement(a,t):-2==n&&t.repeatDate.includes(e)&&this.pushCurManagement(a,t)}}))},pushCurManagement(e,t){const a=[2,0,3,1],n=t.urgent?1:0,s=t.important?1:0;t.index=e,this.currentManagementList[a[2*s+n]].push(t)},getDate(e){const t=e.split("/"),a=new Date(Number(t[0]),Number(t[1])-1,Number(t[2]));return a},getFormattedDate(e,t=null){const a=new Date(e);t&&a.setDate(a.getDate()+t);const n=a.getFullYear(),s=a.getMonth()+1,i=a.getDate();return`${n}/${s}/${i}`},initManagementDate(){this.updateIndex=null,this.management={date:null,deadline:null,repeat:0,content:"",urgent:!1,important:!1,repeatDate:[],finishedDate:[]}},addManagement(){const e=this.management;if(e.date&&e.content){if(-2==e.repeat){const t=this.getDate(e.date),a=[0,1,3,7,14,29,59];e.repeatDate=[],a.forEach((a=>{e.repeatDate.push(this.getFormattedDate(t,a))}))}this.updateIndex?(this.managementList[this.updateIndex]=this.management,this.$toast.show("修改成功","success"),this.updateIndex=null,this.modal_show.addPlanShow=!1):(this.managementList.push(this.management),this.$toast.show("添加成功","success"),this.modal_show.addPlanShow=!1)}else this.$toast.show("时间或内容不得为空","error");console.log(this.managementList),this.ifNeedSave=!0},getManagementDate(e=0){const t=new Date;t.setDate(t.getDate()+e),this.management.date=`${t.getYear()+1900}/${t.getMonth()+1>10?"":0}${t.getMonth()+1}/${t.getDate()>10?"":0}${t.getDate()}`},showAddPlan(e=null){if(!this.draged){if(console.log(e,e.repeat),null==e)this.initManagementDate();else if([1,2,3,4].includes(e))switch(this.initManagementDate(),e){case 1:this.management.urgent=!0,this.management.important=!1;break;case 2:this.management.urgent=!0,this.management.important=!0;break;case 3:this.management.urgent=!1,this.management.important=!1;break;case 4:this.management.urgent=!1,this.management.important=!0;break}else this.management=e;this.modal_show.addPlanShow=!0}},preWeek(){const e=new Date(this.currentWeek[0]);e.setDate(e.getDate()-7),this.getWeekDate(e)},nextWeek(){const e=new Date(this.currentWeek[0]);e.setDate(e.getDate()+7),this.getWeekDate(e)},getWeekDate(e=null){const t=(e,t)=>{const a=new Date(e);return a.setDate(a.getDate()-t),a};this.today=new Date,e=e?new Date(e):t(this.today,this.today.getDay());for(var a=0;a<7;a++)this.currentWeek[a]=t(e,-a)},async fetchJson(){try{const e=(0,S.JU)(P.db,"jsonfiles","managementjson"),t=await(0,S.QT)(e);t.exists()?(this.managementList=t.data().tasks,this.getCurManagementData(this.currentDate),console.log("Document data:",this.jsonData)):console.log("No such document!")}catch(e){console.error("Error fetching document:",e)}},async saveJson(){const e=this.managementList;try{await(0,S.pl)((0,S.JU)(P.db,"jsonfiles","managementjson"),{tasks:e}),this.ifNeedSave=!1,console.log("Document successfully written!")}catch(t){console.error("Error writing document:",t)}},handleBeforeUnload(e){if(this.ifNeedSave){const t="你有未保存的更改，是否保存并离开";return e.returnValue=t,t}},confirmLeave(e,t,a){if(this.ifNeedSave){const e=window.confirm("你有未保存的更改，确定要离开吗？");e?a():a(!1)}else a()}},beforeRouteLeave(e,t,a){this.confirmLeave(e,t,a)}},V=a(8998);const B=(0,V.Z)(j,[["render",Y]]);var q=B}}]);
//# sourceMappingURL=8085.2ba874a7.js.map