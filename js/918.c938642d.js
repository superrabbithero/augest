(self["webpackChunkaugest"]=self["webpackChunkaugest"]||[]).push([[918],{8566:function(t,e,i){i(7658),i(1439),i(7585),i(5315),function(e){t.exports=e()}((function(){return function t(e,i,s){function o(n,a){if(!i[n]){if(!e[n]){var h=void 0;if(!a&&h)return require(n,!0);if(r)return r(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[n]={exports:{}};e[n][0].call(c.exports,(function(t){var i=e[n][1][t];return o(i||t)}),c,c.exports,t,e,i,s)}return i[n].exports}for(var r=void 0,n=0;n<s.length;n++)o(s[n]);return o}({1:[function(t,e,i){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"===typeof t}function r(t){return"number"===typeof t}function n(t){return"object"===typeof t&&null!==t}function a(t){return void 0===t}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},s.prototype.emit=function(t){var e,i,s,r,h,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(i=this._events[t],a(i))return!1;if(o(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(n(i))for(r=Array.prototype.slice.call(arguments,1),l=i.slice(),s=l.length,h=0;h<s;h++)l[h].apply(this,r);return!0},s.prototype.addListener=function(t,e){var i;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?n(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,n(this._events[t])&&!this._events[t].warned&&(i=a(this._maxListeners)?s.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"===typeof console.trace&&console.trace())),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(t,e){if(!o(e))throw TypeError("listener must be a function");var i=!1;function s(){this.removeListener(t,s),i||(i=!0,e.apply(this,arguments))}return s.listener=e,this.on(t,s),this},s.prototype.removeListener=function(t,e){var i,s,r,a;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],r=i.length,s=-1,i===e||o(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(n(i)){for(a=r;a-- >0;)if(i[a]===e||i[a].listener&&i[a].listener===e){s=a;break}if(s<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(s,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},s.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],o(i))this.removeListener(t,i);else if(i)while(i.length)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},s.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[],e},s.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},s.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,i){var s,o,r,n,a;a=navigator.userAgent.toLowerCase(),n=navigator.platform.toLowerCase(),s=a.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],r="ie"===s[1]&&document.documentMode,o={name:"version"===s[1]?s[3]:s[1],version:r||parseFloat("opera"===s[1]&&s[4]?s[4]:s[2]),platform:{name:a.match(/ip(?:ad|od|hone)/)?"ios":(a.match(/(?:webos|android)/)||n.match(/mac|win|linux/)||["other"])[0]}},o[o.name]=!0,o[o.name+parseInt(o.version,10)]=!0,o.platform[o.platform.name]=!0,e.exports=o},{}],3:[function(t,e,i){var s,o,r,n=function(t,e){for(var i in e)a.call(e,i)&&(t[i]=e[i]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t},a={}.hasOwnProperty,h=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},l=[].slice;s=t("events").EventEmitter,r=t("./browser.coffee"),o=function(t){var e,i;function s(t){var i,s,o;for(s in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),e)o=e[s],null==(i=this.options)[s]&&(i[s]=o)}return n(s,t),e={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},i={delay:500,copy:!1},s.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},s.prototype.setOptions=function(t){var e,i,s;for(e in i=[],t)a.call(t,e)&&(s=t[e],i.push(this.setOption(e,s)));return i},s.prototype.addFrame=function(t,e){var s,o;for(o in null==e&&(e={}),s={},s.transparent=this.options.transparent,i)s[o]=e[o]||i[o];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!==typeof ImageData&&null!==ImageData&&t instanceof ImageData)s.data=t.data;else if("undefined"!==typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!==typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?s.data=this.getContextData(t):s.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?s.data=this.getImageData(t):s.image=t}return this.frames.push(s)},s.prototype.render=function(){var t,e,i;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,i;for(i=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)i.push(null);return i}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,i=e;0<=i?t<i:t>i;0<=i?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},s.prototype.abort=function(){var t;while(1){if(t=this.activeWorkers.shift(),null==t)break;this.log("killing active worker"),t.terminate()}return this.running=!1,this.emit("abort")},s.prototype.spawnWorkers=function(){var t,e,i;return t=Math.min(this.options.workers,this.frames.length),function(){i=[];for(var s=e=this.freeWorkers.length;e<=t?s<t:s>t;e<=t?s++:s--)i.push(s);return i}.apply(this).forEach(function(t){return function(e){var i;return t.log("spawning worker "+e),i=new Worker(t.options.workerScript),i.onmessage=function(e){return t.activeWorkers.splice(t.activeWorkers.indexOf(i),1),t.freeWorkers.push(i),t.frameFinished(e.data)},t.freeWorkers.push(i)}}(this)),t},s.prototype.frameFinished=function(t){var e,i;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,!0===this.options.globalPalette&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(e=1,i=this.freeWorkers.length;1<=i?e<i:e>i;1<=i?++e:--e)this.renderNextFrame();return h.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},s.prototype.finishRendering=function(){var t,e,i,s,o,r,n,a,h,l,c,d,g,f,u,p;for(a=0,f=this.imageParts,o=0,h=f.length;o<h;o++)e=f[o],a+=(e.data.length-1)*e.pageSize+e.cursor;for(a+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(a/1e3)+"kb"),t=new Uint8Array(a),d=0,u=this.imageParts,r=0,l=u.length;r<l;r++)for(e=u[r],p=e.data,i=n=0,c=p.length;n<c;i=++n)g=p[i],t.set(g,d),i===e.data.length-1?d+=e.cursor:d+=e.pageSize;return s=new Blob([t],{type:"image/gif"}),this.emit("finished",s,t)},s.prototype.renderNextFrame=function(){var t,e,i;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],i=this.freeWorkers.shift(),e=this.getTask(t),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(i),i.postMessage(e)},s.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},s.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),e=this._canvas.getContext("2d"),e.setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},s.prototype.getTask=function(t){var e,i;if(e=this.frames.indexOf(t),i={index:e,last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===r.name},null!=t.data)i.data=t.data;else if(null!=t.context)i.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");i.data=this.getImageData(t.image)}return i},s.prototype.log=function(){var t;if(t=1<=arguments.length?l.call(arguments,0):[],this.options.debug)return console.log.apply(console,t)},s}(s),e.exports=o},{"./browser.coffee":2,events:1}]},{},[3])(3)}))},6077:function(t,e,i){"use strict";var s=i(614),o=String,r=TypeError;t.exports=function(t){if("object"==typeof t||s(t))return t;throw r("Can't set "+o(t)+" as a prototype")}},3013:function(t){"use strict";t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(t,e,i){"use strict";var s,o,r,n=i(3013),a=i(9781),h=i(7854),l=i(614),c=i(111),d=i(2597),g=i(648),f=i(6330),u=i(8880),p=i(8052),m=i(7045),v=i(7976),w=i(9518),y=i(7674),x=i(5112),C=i(9711),S=i(9909),_=S.enforce,I=S.get,D=h.Int8Array,z=D&&D.prototype,b=h.Uint8ClampedArray,k=b&&b.prototype,R=D&&w(D),L=z&&w(z),A=Object.prototype,P=h.TypeError,M=x("toStringTag"),T=C("TYPED_ARRAY_TAG"),F="TypedArrayConstructor",$=n&&!!y&&"Opera"!==g(h.opera),E=!1,W={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},U={BigInt64Array:8,BigUint64Array:8},V=function(t){if(!c(t))return!1;var e=g(t);return"DataView"===e||d(W,e)||d(U,e)},O=function(t){var e=w(t);if(c(e)){var i=I(e);return i&&d(i,F)?i[F]:O(e)}},B=function(t){if(!c(t))return!1;var e=g(t);return d(W,e)||d(U,e)},N=function(t){if(B(t))return t;throw P("Target is not a typed array")},j=function(t){if(l(t)&&(!y||v(R,t)))return t;throw P(f(t)+" is not a typed array constructor")},H=function(t,e,i,s){if(a){if(i)for(var o in W){var r=h[o];if(r&&d(r.prototype,t))try{delete r.prototype[t]}catch(n){try{r.prototype[t]=e}catch(l){}}}L[t]&&!i||p(L,t,i?e:$&&z[t]||e,s)}},G=function(t,e,i){var s,o;if(a){if(y){if(i)for(s in W)if(o=h[s],o&&d(o,t))try{delete o[t]}catch(r){}if(R[t]&&!i)return;try{return p(R,t,i?e:$&&R[t]||e)}catch(r){}}for(s in W)o=h[s],!o||o[t]&&!i||p(o,t,e)}};for(s in W)o=h[s],r=o&&o.prototype,r?_(r)[F]=o:$=!1;for(s in U)o=h[s],r=o&&o.prototype,r&&(_(r)[F]=o);if((!$||!l(R)||R===Function.prototype)&&(R=function(){throw P("Incorrect invocation")},$))for(s in W)h[s]&&y(h[s],R);if((!$||!L||L===A)&&(L=R.prototype,$))for(s in W)h[s]&&y(h[s].prototype,L);if($&&w(k)!==L&&y(k,L),a&&!d(L,M))for(s in E=!0,m(L,M,{configurable:!0,get:function(){return c(this)?this[T]:void 0}}),W)h[s]&&u(h[s],T,s);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:$,TYPED_ARRAY_TAG:E&&T,aTypedArray:N,aTypedArrayConstructor:j,exportTypedArrayMethod:H,exportTypedArrayStaticMethod:G,getTypedArrayConstructor:O,isView:V,isTypedArray:B,TypedArray:R,TypedArrayPrototype:L}},7745:function(t,e,i){"use strict";var s=i(6244);t.exports=function(t,e){var i=0,o=s(e),r=new t(o);while(o>i)r[i]=e[i++];return r}},1843:function(t,e,i){"use strict";var s=i(6244);t.exports=function(t,e){for(var i=s(t),o=new e(i),r=0;r<i;r++)o[r]=t[i-r-1];return o}},1572:function(t,e,i){"use strict";var s=i(6244),o=i(9303),r=RangeError;t.exports=function(t,e,i,n){var a=s(t),h=o(i),l=h<0?a+h:h;if(l>=a||l<0)throw r("Incorrect index");for(var c=new e(a),d=0;d<a;d++)c[d]=d===l?n:t[d];return c}},648:function(t,e,i){"use strict";var s=i(1694),o=i(614),r=i(4326),n=i(5112),a=n("toStringTag"),h=Object,l="Arguments"==r(function(){return arguments}()),c=function(t,e){try{return t[e]}catch(i){}};t.exports=s?r:function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=c(e=h(t),a))?i:l?r(e):"Object"==(s=r(e))&&o(e.callee)?"Arguments":s}},8544:function(t,e,i){"use strict";var s=i(7293);t.exports=!s((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},7045:function(t,e,i){"use strict";var s=i(6339),o=i(3070);t.exports=function(t,e,i){return i.get&&s(i.get,e,{getter:!0}),i.set&&s(i.set,e,{setter:!0}),o.f(t,e,i)}},6106:function(t,e,i){"use strict";var s=i(1702),o=i(9662);t.exports=function(t,e,i){try{return s(o(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(r){}}},4067:function(t,e,i){"use strict";var s=i(648);t.exports=function(t){var e=s(t);return"BigInt64Array"==e||"BigUint64Array"==e}},9518:function(t,e,i){"use strict";var s=i(2597),o=i(614),r=i(7908),n=i(6200),a=i(8544),h=n("IE_PROTO"),l=Object,c=l.prototype;t.exports=a?l.getPrototypeOf:function(t){var e=r(t);if(s(e,h))return e[h];var i=e.constructor;return o(i)&&e instanceof i?i.prototype:e instanceof l?c:null}},7674:function(t,e,i){"use strict";var s=i(6106),o=i(9670),r=i(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{t=s(Object.prototype,"__proto__","set"),t(i,[]),e=i instanceof Array}catch(n){}return function(i,s){return o(i),r(s),e?t(i,s):i.__proto__=s,i}}():void 0)},4599:function(t,e,i){"use strict";var s=i(7593),o=TypeError;t.exports=function(t){var e=s(t,"number");if("number"==typeof e)throw o("Can't convert number to bigint");return BigInt(e)}},1694:function(t,e,i){"use strict";var s=i(5112),o=s("toStringTag"),r={};r[o]="z",t.exports="[object z]"===String(r)},1340:function(t,e,i){"use strict";var s=i(648),o=String;t.exports=function(t){if("Symbol"===s(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},8053:function(t){"use strict";var e=TypeError;t.exports=function(t,i){if(t<i)throw e("Not enough arguments");return t}},1439:function(t,e,i){"use strict";var s=i(1843),o=i(260),r=o.aTypedArray,n=o.exportTypedArrayMethod,a=o.getTypedArrayConstructor;n("toReversed",(function(){return s(r(this),a(this))}))},7585:function(t,e,i){"use strict";var s=i(260),o=i(1702),r=i(9662),n=i(7745),a=s.aTypedArray,h=s.getTypedArrayConstructor,l=s.exportTypedArrayMethod,c=o(s.TypedArrayPrototype.sort);l("toSorted",(function(t){void 0!==t&&r(t);var e=a(this),i=n(h(e),e);return c(i,t)}))},5315:function(t,e,i){"use strict";var s=i(1572),o=i(260),r=i(4067),n=i(9303),a=i(4599),h=o.aTypedArray,l=o.getTypedArrayConstructor,c=o.exportTypedArrayMethod,d=!!function(){try{new Int8Array(1)["with"](2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();c("with",{with:function(t,e){var i=h(this),o=n(t),c=r(i)?a(e):+e;return s(i,l(i),o,c)}}["with"],!d)},6229:function(t,e,i){"use strict";var s=i(8052),o=i(1702),r=i(1340),n=i(8053),a=URLSearchParams,h=a.prototype,l=o(h.append),c=o(h["delete"]),d=o(h.forEach),g=o([].push),f=new a("a=1&a=2&b=3");f["delete"]("a",1),f["delete"]("b",void 0),f+""!=="a=2"&&s(h,"delete",(function(t){var e=arguments.length,i=e<2?void 0:arguments[1];if(e&&void 0===i)return c(this,t);var s=[];d(this,(function(t,e){g(s,{key:e,value:t})})),n(e,1);var o,a=r(t),h=r(i),f=0,u=0,p=!1,m=s.length;while(f<m)o=s[f++],p||o.key===a?(p=!0,c(this,o.key)):u++;while(u<m)o=s[u++],o.key===a&&o.value===h||l(this,o.key,o.value)}),{enumerable:!0,unsafe:!0})},7330:function(t,e,i){"use strict";var s=i(8052),o=i(1702),r=i(1340),n=i(8053),a=URLSearchParams,h=a.prototype,l=o(h.getAll),c=o(h.has),d=new a("a=1");!d.has("a",2)&&d.has("a",void 0)||s(h,"has",(function(t){var e=arguments.length,i=e<2?void 0:arguments[1];if(e&&void 0===i)return c(this,t);var s=l(this,t);n(e,1);var o=r(i),a=0;while(a<s.length)if(s[a++]===o)return!0;return!1}),{enumerable:!0,unsafe:!0})},2062:function(t,e,i){"use strict";var s=i(9781),o=i(1702),r=i(7045),n=URLSearchParams.prototype,a=o(n.forEach);s&&!("size"in n)&&r(n,"size",{get:function(){var t=0;return a(this,(function(){t++})),t},configurable:!0,enumerable:!0})},4903:function(t,e,i){"use strict";i.d(e,{Z:function(){return f}});var s=i(9812),o=i(5893);const r=t=>((0,s.dD)("data-v-548b4f26"),t=t(),(0,s.Cn)(),t),n=r((()=>(0,s._)("div",{class:"draged-bar-handle"},null,-1))),a=[n],h={class:"modal-slot"};function l(t,e,i,r,n,l){return(0,s.wg)(),(0,s.iD)("div",{class:(0,o.C_)({"au-draged":!0,dragging:n.dragedel,row:1==n.style||3==n.style}),ref:"modal"},[(0,s._)("div",{class:(0,o.C_)({"draged-bar":!0,draged:i.dragable}),onPointerdown:e[0]||(e[0]=t=>l.dragdown(t)),onPointerup:e[1]||(e[1]=(...t)=>l.dragup&&l.dragup(...t))},a,34),(0,s._)("div",h,[(0,s.WI)(t.$slots,"default",{},void 0,!0)])],2)}var c={props:{modalKey:{type:String,required:!0},dragable:{type:Boolean,required:!1,default:!0},modeless:{type:Boolean,required:!1,default:!0}},data(){return{draged:!1,dragedel:null,disx:0,disy:0,left:0,top:0,style:0}},methods:{dragdown(t){this.dragable&&(this.dragedel=this.$refs.modal,this.disx=t.pageX-this.dragedel.offsetLeft,this.disy=t.pageY-this.dragedel.offsetTop,document.addEventListener("pointermove",this.dragmove))},dragup(){this.top<50&&(this.dragedel.style.top="0px",this.style=1),this.left<50&&(this.dragedel.style.left="0px",this.style=4);const t=this.dragedel.parentElement.clientWidth-this.dragedel.clientWidth,e=this.dragedel.parentElement.clientHeight-this.dragedel.clientHeight;this.top>e-50&&(this.dragedel.style.top="unset",this.dragedel.style.bottom="0",this.style=3),this.left>t-50&&(this.dragedel.style.left="unset",this.dragedel.style.right="0",this.style=2),this.dragedel=null,document.removeEventListener("pointermove",this.dragmove)},dragmove(t){this.dragedel&&(this.dragedel.style.bottom="unset",this.dragedel.style.right="unset",this.left=t.pageX-this.disx,this.top=t.pageY-this.disy,this.dragedel.style.left=this.left+"px",this.dragedel.style.top=this.top+"px")}}},d=i(8998);const g=(0,d.Z)(c,[["render",l],["__scopeId","data-v-548b4f26"]]);var f=g},9241:function(t,e,i){"use strict";i.d(e,{Z:function(){return d}});var s=i(9812),o=i(5893);const r={class:"select-box",ref:"selectBox"},n=["onClick"];function a(t,e,i,a,h,l){const c=(0,s.up)("svg-icon");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",{class:(0,o.C_)({"input-area":!0,active:h.selectShow}),onClick:e[0]||(e[0]=(...t)=>l.openSelect&&l.openSelect(...t))},[(0,s.Uk)((0,o.zw)(i.dataList[h.currIndex])+" ",1),(0,s.Wm)(c,{name:"arrow-down",size:"16",class:(0,o.C_)({icon:!0,show:h.selectShow})},null,8,["class"])],2),(0,s._)("div",{class:(0,o.C_)({"select-item-group":!0,show:h.selectShow}),ref:"options"},[(0,s._)("div",{class:(0,o.C_)({options:!0,show:h.selectShow})},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.dataList,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{class:(0,o.C_)({"select-item":!0,active:e==h.currIndex}),onClick:t=>l.changeIndex(e)},(0,o.zw)(t),11,n)))),256))],2)],2)],512)}var h={props:{dataList:{type:Array,required:!0}},data(){return{selectShow:!1,currIndex:0}},mounted(){},unmounted(){document.removeEventListener("click",this.closeSelect)},methods:{openSelect(){this.selectShow?(this.selectShow=!1,document.removeEventListener("click",this.closeSelect)):(this.selectShow=!0,document.addEventListener("click",this.closeSelect))},closeSelect(){this.$refs.selectBox.contains(event.target)||(this.selectShow=!1,document.removeEventListener("click",this.closeSelect))},changeIndex(t){this.currIndex=t,this.selectShow=!1,document.removeEventListener("click",this.closeSelect),this.$emit("change",this.currIndex)}}},l=i(8998);const c=(0,l.Z)(h,[["render",a],["__scopeId","data-v-2ee630a8"]]);var d=c},918:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return tt}});var s=i(9812),o=i(4220),r=i(5893);const n=t=>((0,s.dD)("data-v-5c46f14d"),t=t(),(0,s.Cn)(),t),a={class:"center-h"},h=n((()=>(0,s._)("label",null,"画布大小：",-1))),l={class:"size"},c=n((()=>(0,s._)("span",null,"x",-1))),d={class:"center-h",style:{"align-items":"flex-end"}},g=n((()=>(0,s._)("label",null,"画布预设：",-1))),f=["onClick"],u=n((()=>(0,s._)("sup",null,"2",-1))),p={class:"center-h"},m=n((()=>(0,s._)("label",null,"网格大小:",-1))),v={class:"center-h"},w=n((()=>(0,s._)("label",null,"导出网格大小:",-1))),y={class:"center-h left"},x={class:"tool-setting-bar"},C={class:"left"},S={class:"tool-option"},_={class:"label",style:{width:"91px"}},I={class:"right"},D={class:"icon-item"},z={class:"size"},b=n((()=>(0,s._)("span",null,"x",-1))),k={class:"icon-item"},R={class:"work-area"},L={style:{display:"flex","flex-grow":"1",overflow:"hidden"}},A={class:"tools-bar"},P={class:"tool-item-fullscreen"},M={style:{position:"absolute",left:"1rem"}},T=["width","height"],F={class:"right"},$=["width","height"],E={class:"overview-tools"},W={class:"color-item draged",ref:"dragedColor"},U=["onPointerdown","onPointerup"],V={class:"color-item"},O={class:"color-tools"},B={class:"gif-tools",style:{"justify-content":"center"}},N={class:"fps-label"},j={class:"gif-tools",style:{height:"80px"}},H=["width","onClick"];function G(t,e,i,n,G,Y){const q=(0,s.up)("my-model"),K=(0,s.up)("svg-icon"),X=(0,s.up)("auDraged"),Z=(0,s.up)("au-select");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(q,{show:G.modal_show.newFileModalShow,modeless:!1,modalKey:"newFileModalShow"},{default:(0,s.w5)((()=>[(0,s._)("div",a,[h,(0,s._)("div",l,[(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>G.newFileForm.rows=t)},null,512),[[o.nr,G.newFileForm.rows]]),c,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>G.newFileForm.cols=t)},null,512),[[o.nr,G.newFileForm.cols]])])]),(0,s._)("div",d,[g,((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)([64,32,16,13,11],(t=>(0,s._)("div",{onClick:e=>(G.newFileForm.rows=t,G.newFileForm.cols=t),style:(0,r.j5)({width:`${t}px`,height:`${t}px`,fontSize:.5*t+"px",border:"1px solid var(--fontNormal)",marginRight:"4px",cursor:"pointer"})},[(0,s.Uk)((0,r.zw)(t),1),u],12,f))),64))]),(0,s._)("div",p,[m,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=t=>G.newFileForm.gridSize=t)},null,512),[[o.nr,G.newFileForm.gridSize]])]),(0,s._)("div",v,[w,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=t=>G.newFileForm.outputSize=t)},null,512),[[o.nr,G.newFileForm.outputSize]])]),(0,s._)("div",y,[(0,s._)("button",{class:"fill",onClick:e[4]||(e[4]=t=>Y.newFile())},"新 建")])])),_:1},8,["show"]),(0,s._)("div",x,[(0,s._)("div",C,[(0,s._)("div",{class:"tool-option",onClick:e[5]||(e[5]=t=>G.modal_show.newFileModalShow=!0)},[(0,s.Wm)(K,{name:"file-create01"})]),(0,s._)("div",S,[(0,s._)("div",_,"画笔大小("+(0,r.zw)(G.penSize)+"):",1),(0,s.wy)((0,s._)("input",{type:"range",style:{color:"currentColor"},"onUpdate:modelValue":e[6]||(e[6]=t=>G.penSize=t),min:"1",max:"20"},null,512),[[o.nr,G.penSize]])])]),(0,s._)("div",I,[(0,s._)("div",{class:"icon-item",onClick:e[7]||(e[7]=t=>G.gifToolsShow=!G.gifToolsShow)},[(0,s.Wm)(K,{name:"file-gif"})]),(0,s._)("div",{class:"icon-item",onClick:e[8]||(e[8]=t=>G.toolsShow=!G.toolsShow)},[(0,s.Wm)(K,{name:"phone"})]),(0,s._)("div",{class:"icon-item",onClick:e[9]||(e[9]=(...t)=>Y.undo&&Y.undo(...t))},[(0,s.Wm)(K,{name:"undo01"})]),(0,s._)("div",{class:"icon-item-box",onClick:e[12]||(e[12]=t=>Y.dropDown(t,"sizeSettingShow"))},[(0,s._)("div",D,[(0,s.Wm)(K,{name:"canvas01"})]),(0,s._)("div",{class:(0,r.C_)({"size-setting":!0,show:G.dropDownBoxShow.sizeSettingShow})},[(0,s.Uk)(" 画布大小： "),(0,s._)("div",z,[(0,s.wy)((0,s._)("input",{type:"number","onUpdate:modelValue":e[10]||(e[10]=t=>G.rows=t)},null,512),[[o.nr,G.rows]]),b,(0,s.wy)((0,s._)("input",{type:"number","onUpdate:modelValue":e[11]||(e[11]=t=>G.cols=t)},null,512),[[o.nr,G.cols]])])],2)]),(0,s._)("div",{class:"icon-item-box",onClick:e[17]||(e[17]=t=>Y.dropDown(t,"downloadShow"))},[(0,s._)("div",k,[(0,s.Wm)(K,{name:"download01"})]),(0,s._)("div",{class:(0,r.C_)({"size-setting":!0,show:G.dropDownBoxShow.downloadShow})},[(0,s._)("div",{class:"drop-down-option",onClick:e[13]||(e[13]=(...t)=>Y.saveAsSvg&&Y.saveAsSvg(...t))},"保存成 svg"),(0,s._)("div",{class:"drop-down-option",onClick:e[14]||(e[14]=(...t)=>Y.copySvgCode&&Y.copySvgCode(...t))},"复制 svg 代码"),(0,s._)("div",{class:"drop-down-option",onClick:e[15]||(e[15]=(...t)=>Y.saveAsPng&&Y.saveAsPng(...t))},"保存成 png"),(0,s._)("div",{class:"drop-down-option",onClick:e[16]||(e[16]=(...t)=>Y.saveAsGif&&Y.saveAsGif(...t))},"保存成 gif")],2)])])]),(0,s._)("div",R,[(0,s._)("div",L,[(0,s.Wm)(X,null,{default:(0,s.w5)((()=>[(0,s._)("div",A,[(0,s._)("div",{class:(0,r.C_)({"tool-item":!0,active:1==G.tool}),onClick:e[18]||(e[18]=t=>Y.switchTool(1))},[(0,s.Wm)(K,{name:"pencil",className:"tool-item-svg"})],2),(0,s._)("div",{class:(0,r.C_)({"tool-item":!0,active:2==G.tool}),onClick:e[19]||(e[19]=t=>Y.switchTool(2))},[(0,s.Wm)(K,{name:"eraser",className:"tool-item-svg"})],2),(0,s._)("div",{class:(0,r.C_)({"tool-item":!0,active:3==G.tool}),onClick:e[20]||(e[20]=t=>Y.switchTool(3))},[(0,s.Wm)(K,{name:"line",className:"tool-item-svg"})],2),(0,s._)("div",{class:(0,r.C_)({"tool-item":!0,active:4==G.tool}),onClick:e[21]||(e[21]=t=>Y.switchTool(4))},[(0,s.Wm)(K,{name:"rect",className:"tool-item-svg"})],2),(0,s._)("div",{class:(0,r.C_)({"tool-item":!0,active:5==G.tool}),onClick:e[22]||(e[22]=t=>Y.switchTool(5))},[(0,s.Wm)(K,{name:"circle",className:"tool-item-svg"})],2),(0,s._)("div",{class:(0,r.C_)({"tool-item":!0,active:6==G.tool}),onClick:e[23]||(e[23]=t=>Y.switchTool(6))},[(0,s.Wm)(K,{name:"paintBuckets",className:"tool-item-svg"})],2),(0,s._)("div",{class:(0,r.C_)({"tool-item":!0,active:7==G.tool}),onClick:e[24]||(e[24]=t=>Y.switchTool(7))},[(0,s.Wm)(K,{name:"select",className:"tool-item-svg"})],2),(0,s._)("div",{class:"tool-item",onClick:e[25]||(e[25]=(...t)=>Y.clearAll&&Y.clearAll(...t))},[(0,s.Wm)(K,{name:"delete02",className:"tool-item-svg"})]),(0,s._)("div",{class:"tool-item",onClick:e[27]||(e[27]=(...t)=>Y.openFileInput&&Y.openFileInput(...t))},[(0,s.Wm)(K,{name:"picture-add",className:"tool-item-svg"}),(0,s.wy)((0,s._)("input",{type:"file",id:"fileInput",onChange:e[26]||(e[26]=(...t)=>Y.importImg&&Y.importImg(...t)),accept:"image/*"},null,544),[[o.F8,!1]])]),(0,s._)("div",P,[(0,s._)("div",{class:"color back",style:(0,r.j5)({backgroundColor:G.bkgColor}),onClick:e[28]||(e[28]=t=>[G.currentColor,G.bkgColor]=[G.bkgColor,G.currentColor])},null,4),(0,s._)("div",{class:"color front",style:(0,r.j5)({backgroundColor:G.currentColor})},[(0,s._)("input",{type:"color",class:"colorInput-hidden",ref:"addColor1",onChange:e[29]||(e[29]=t=>Y.addColor(t))},null,544)],4)])])])),_:1}),(0,s._)("div",{class:"middle",onPointermove:e[31]||(e[31]=(...t)=>Y.handlePointerMove&&Y.handlePointerMove(...t)),onPointerup:e[32]||(e[32]=(...t)=>Y.handlePointerUp&&Y.handlePointerUp(...t)),ref:"realViewport",onWheel:e[33]||(e[33]=(...t)=>Y.zoomWheel&&Y.zoomWheel(...t))},[(0,s._)("div",M,(0,r.zw)(G.coordinate),1),(0,s._)("div",{class:"drawing-area",onPointerdown:e[30]||(e[30]=(...t)=>Y.handlePointerDown&&Y.handlePointerDown(...t))},[(0,s._)("canvas",{width:Y.width,height:Y.height,class:"gridstyle",style:(0,r.j5)(Y.canvasStyle),ref:"canvas"},null,12,T)],32)],544),(0,s.wy)((0,s._)("div",F,[(0,s._)("div",{class:"overview",onPointermove:e[35]||(e[35]=(...t)=>Y.dragViewportMove&&Y.dragViewportMove(...t)),onPointerup:e[36]||(e[36]=(...t)=>Y.dragViewportUp&&Y.dragViewportUp(...t)),onWheel:e[37]||(e[37]=(...t)=>Y.zoomWheel&&Y.zoomWheel(...t))},[(0,s._)("canvas",{class:"gridstyle",ref:"canvas_overview",style:(0,r.j5)(Y.overviewStyle),width:Y.overviewSize.width,height:Y.overviewSize.height},null,12,$),(0,s._)("div",{class:"viewport",ref:"viewport",onPointerdown:e[34]||(e[34]=(...t)=>Y.dragViewportDown&&Y.dragViewportDown(...t))},null,544)],32),(0,s._)("div",E,[(0,s._)("div",{class:"icon-item",onClick:e[38]||(e[38]=(...t)=>Y.zoomIn&&Y.zoomIn(...t))},[(0,s.Wm)(K,{name:"zoomIn11-1"})]),(0,s._)("div",{class:"icon-item",onClick:e[39]||(e[39]=(...t)=>Y.zoomOut&&Y.zoomOut(...t))},[(0,s.Wm)(K,{name:"zoomOut11-1"})]),(0,s.wy)((0,s._)("input",{type:"range",style:{width:"80px",color:"currentColor"},min:"10",max:"100","onUpdate:modelValue":e[40]||(e[40]=t=>G.scaleCount=t),onInput:e[41]||(e[41]=(...t)=>Y.resizeViewport&&Y.resizeViewport(...t))},null,544),[[o.nr,G.scaleCount]]),(0,s._)("div",{class:"icon-item",onClick:e[42]||(e[42]=(...t)=>Y.zoomFit&&Y.zoomFit(...t))},[(0,s.Wm)(K,{name:"zoomFit11-1"})])]),(0,s.Wm)(Z,{dataList:["默认","Pixel-8"],onChange:Y.changeMyColor,style:{"margin-bottom":"5px"}},null,8,["onChange"]),(0,s._)("div",{class:"color-tools",ref:"colorTools",onPointermove:e[45]||(e[45]=e=>Y.handleMove(e,t.index))},[(0,s.wy)((0,s._)("div",W,null,512),[[o.F8,null!=G.dragedColorIndex]]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(G.myColors,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{class:"color-item",ref_for:!0,ref:"colorItem",style:(0,r.j5)({backgroundColor:t}),onPointerdown:t=>Y.handleStart(t,e),onPointerup:t=>Y.handleEnd(t,e)},null,44,U)))),256)),(0,s._)("div",V,[(0,s.Uk)("+ "),(0,s._)("input",{type:"color",class:"colorInput-hidden",ref:"addColor2",onChange:e[43]||(e[43]=t=>Y.addColor(t))},null,544)]),(0,s._)("div",{class:(0,r.C_)({"color-item delete":!0,show:null!=G.dragedColorIndex}),onPointerup:e[44]||(e[44]=e=>Y.handleEnd(t.event,-1))},[(0,s.Wm)(K,{name:"delete02",className:"color-item-svg"})],34)],544),(0,s._)("div",O,[(0,s.Uk)(" 融合阈值："),(0,s.wy)((0,s._)("input",{type:"number",min:"0",max:"100",step:"10","onUpdate:modelValue":e[46]||(e[46]=t=>G.threshold=t)},null,512),[[o.nr,G.threshold]]),(0,s._)("button",{onClick:e[47]||(e[47]=(...t)=>Y.imgToPixel&&Y.imgToPixel(...t))},"像素转换"),(0,s._)("button",{onClick:e[48]||(e[48]=(...t)=>Y.adjustImg&&Y.adjustImg(...t))},"像素融合")])],512),[[o.F8,G.toolsShow]])]),(0,s._)("div",{class:(0,r.C_)({"gif-tools-box":!0,show:G.gifToolsShow})},[(0,s._)("div",B,[(0,s.Wm)(K,{class:"gif-tools-item",name:"replay02",onClick:e[49]||(e[49]=t=>(G.gifImageDataIndex=0,Y.startAnimate()))}),(0,s.Wm)(K,{class:"gif-tools-item",name:"pause01",onClick:Y.stopAnimate},null,8,["onClick"]),(0,s._)("div",{class:"gif-tools-item has-icon-button",style:{position:"relative"},onClick:e[50]||(e[50]=t=>Y.changeSpeed(1))},[(0,s.Wm)(K,{name:"film11-1"}),(0,s._)("label",N,(0,r.zw)(`${G.animateFps[G.animateFpsIndex]}`),1)]),(0,s.Wm)(K,{class:"gif-tools-item",onClick:e[51]||(e[51]=t=>Y.pushGifImgList()),name:"letter-plus01"}),(0,s.Wm)(K,{class:"gif-tools-item",onClick:e[52]||(e[52]=t=>Y.deleteGifImgList()),name:"letter-minus01"}),(0,s._)("button",{class:"gif-tools-item",onClick:e[53]||(e[53]=t=>Y.saveGifNPngToFolder(G.gifImageDataList))},"导出")]),(0,s._)("div",j,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(G.gifImageDataList.length,(t=>((0,s.wg)(),(0,s.iD)("canvas",{ref_for:!0,ref:"gifCanvas",width:100*G.cols/G.rows,height:"100",class:(0,r.C_)({gifCanvas:!0,currentGifCanvas:t-1==G.gifImageDataIndex}),onClick:e=>Y.putGifImage2MainCanvas(t-1)},null,10,H)))),256)),(0,s.wy)((0,s._)("div",{class:"addcanvas",onClick:e[54]||(e[54]=t=>Y.pushGifImgList())},"+",512),[[o.F8,0==G.gifImageDataList.length]])])],2)])],64)}i(7658),i(6229),i(7330),i(2062);var Y=i(8566),q=i.n(Y),K=i(9241),X=i(4903),Z={data(){return{tool:1,rows:11,cols:11,gridSize:100,outputSize:30,coordinate:"x:0,y:0",currentColor:"#000001",bkgColor:"#fff",myColors:["#000001","#ffffff","#F96635","#f9A822","#FAEC86","#93d3a2","#2bbaa5","#008080"],defaultColors:["#000001","#ffffff","#F96635","#f9A822","#FAEC86","#93d3a2","#2bbaa5","#008080"],pix8Colors:["#000001","#ffffff","#202952","#762b52","#398557","#a1573e","#605750","#c4c3c8","#fef1eb","#eb3452","#f1a73c","#fcee5a","#67e055","#57a8f7","#807498","#ee7dab","#f6cdb1"],colorIndex:0,dragedColorIndex:null,isDrawing:!1,pixels:[],endPoints:{x:0,y:0},maincanvas:null,ctx:null,ovCtx:null,historys:[],log:"",shiftdown:!1,dropDownBox:null,dropDownBoxShow:{sizeSettingShow:!1,downloadShow:!1},penSize:1,scaleCount:30,minScaleCount:30,viewport:null,disx:0,disy:0,selectedRect:{x:0,y:0,width:0,height:0},offscreenCanvas:null,selectedImgData:null,selectedBgData:null,isDragingSelectRect:!1,selectRectAnimateId:0,pressTimer:null,toolsShow:!0,modal_show:{newFileModalShow:!1},newFileForm:{cols:13,rows:13,gridSize:100,outputSize:30},gifToolsShow:!1,gifImageDataList:[],animateId:0,gifImageDataIndex:-1,animateStartTime:null,animateFps:[3,4,5,10,30,60],animateFpsIndex:0,animateSpeed:300,imgToPixelTools:!1,threshold:0,imgPointList:[[]]}},components:{auSelect:K.Z,auDraged:X.Z},computed:{width(){return this.cols*this.gridSize},height(){return this.rows*this.gridSize},overviewSize(){let t=180,e=t/this.cols*this.rows;return e>140&&(e=140,t=e/this.rows*this.cols),{width:t,height:e}},overviewStyle(){const t=this.overviewSize.width/this.cols;return{backgroundSize:`${2*t}px ${2*t}px`,backgroundPosition:`0 0 , ${t}px ${t}px`}},canvasStyle(){const t=this.scaleCount/100,e=this.gridSize*t;return{width:this.width*t+"px",height:this.height*t+"px",backgroundSize:`${2*e}px ${2*e}px`,backgroundPosition:`0 0 , ${e}px ${e}px`}}},mounted(){this.init(),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),this.$refs.realViewport.addEventListener("scroll",this.viewportScroll)},unmounted(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),this.$refs.realViewport&&this.$refs.realViewport.removeEventListener("scroll",this.viewportScroll),document.removeEventListener("click",this.closeDropDownBox)},methods:{changeMyColor(t){0==t?this.myColors=this.defaultColors:1==t&&(this.myColors=this.pix8Colors)},newFile(){this.cols=Math.floor(this.newFileForm.cols),this.gridSize=Math.floor(this.newFileForm.gridSize),this.rows=Math.floor(this.newFileForm.rows),this.outputSize=Math.floor(this.newFileForm.outputSize),this.historys=[],this.clearAll(),this.modal_show.newFileModalShow&&(this.modal_show.newFileModalShow=!1)},handleStart(t,e){this.pressTimer=setTimeout((()=>{this.dragedColorIndex=e;const i=t.target;this.disx=t.pageX-i.offsetLeft,this.disy=t.pageY-i.offsetTop;const s=this.$refs.dragedColor;s.style.backgroundColor=this.myColors[this.dragedColorIndex],s.style.left=t.pageX-this.disx+"px",s.style.top=t.pageY-this.disy+"px",clearTimeout(this.pressTimer),this.pressTimer=null}),500)},handleMove(t,e){if(this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=null),null!=this.dragedColorIndex){const e=this.$refs.dragedColor;e.style.backgroundColor=this.myColors[this.dragedColorIndex],e.style.left=t.pageX-this.disx+"px",e.style.top=t.pageY-this.disy+"px"}},handleEnd(t,e){if(this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=null,this.selectColor(e)),null!=this.dragedColorIndex)if(-1==e)this.myColors.splice(this.dragedColorIndex,1),this.dragedColorIndex=null;else{const t=this.myColors[e];this.myColors[e]=this.myColors[this.dragedColorIndex],this.myColors[this.dragedColorIndex]=t,this.dragedColorIndex=null}},selectColor(t){this.currentColor=this.myColors[t]},addColor(t){const e=t.currentTarget,i=e.value;this.myColors.includes(i)||this.myColors.push(i),this.currentColor=i},switchTool(t){this.tool!=t&&(7==this.tool&&(this.selectedImgData=null,this.selectedRect={x:0,y:0,width:0,height:0},cancelAnimationFrame(this.selectRectAnimateId),this.selectRectAnimateId=0,this.showLastHistory()),7==t&&(this.selectedBgData=this.ctx.getImageData(0,0,this.width,this.height)),this.tool=t)},updateOverview(){this.ovCtx.clearRect(0,0,this.overviewSize.width,this.overviewSize.height),this.ovCtx.drawImage(this.maincanvas,0,0,this.width,this.height,0,0,this.overviewSize.width,this.overviewSize.height)},dropDown(t,e){this.dropDownBox=t.target;const i=Object.keys(this.dropDownBoxShow);i.forEach((t=>{this.dropDownBoxShow[t]=!1})),this.dropDownBoxShow[e]=!0,document.addEventListener("click",this.closeDropDownBox)},closeDropDownBox(t){if(!this.dropDownBox.contains(t.target)){const t=Object.keys(this.dropDownBoxShow);t.forEach((t=>{this.dropDownBoxShow[t]=!1})),document.removeEventListener("click",this.closeDropDownBox)}},handleKeyDown(t){"Shift"===t.key&&(this.shiftdown=!0)},handleKeyUp(t){"Shift"===t.key&&(this.shiftdown=!1)},init(){window.PointerEvent&&(this.log="Pointer events are supported."),this.maincanvas=this.$refs.canvas;const t=this.$refs.canvas_overview;this.ctx=this.maincanvas.getContext("2d"),this.ctx.lineWidth=1,this.ovCtx=t.getContext("2d"),this.addHistory(),this.resizeViewport(),this.getMinScale(),this.scaleCount=this.minScaleCount,this.offscreenCanvas=document.createElement("canvas")},getMinScale(){const t=this.$refs.realViewport;let e=t.clientWidth-5,i=e/this.cols*this.rows;i>t.clientHeight&&(i=t.clientHeight-2,e=i/this.rows*this.cols),this.minScaleCount=Math.floor(100*e/this.width),this.log=this.minScaleCount},handlePointerDown(t){if(this.endPoints=this.getPoint({x:t.clientX,y:t.clientY}),2==this.tool)this.isDrawing=!0,this.clearPixel(this.endPoints);else if(this.tool<6)this.isDrawing=!0,this.drawPixel(this.endPoints);else if(6==this.tool)this.ctx.fillStyle=this.currentColor,this.fillArea(this.endPoints),this.addHistory();else if(7==this.tool){this.ctx.beginPath(),this.ctx.rect(this.selectedRect.x,this.selectedRect.y,this.selectedRect.width,this.selectedRect.height),this.ctx.closePath();const t=this.ctx.isPointInPath(this.endPoints.x,this.endPoints.y);if(t){if(this.selectedImgData)this.ctx.putImageData(this.selectedBgData,0,0);else{this.showLastHistory(),this.selectedImgData=this.ctx.getImageData(this.selectedRect.x,this.selectedRect.y,this.selectedRect.width,this.selectedRect.height),this.offscreenCanvas.width=this.selectedRect.width,this.offscreenCanvas.height=this.selectedRect.height;const t=this.offscreenCanvas.getContext("2d");this.showLastHistory(),this.ctx.clearRect(this.selectedRect.x,this.selectedRect.y,this.selectedRect.width,this.selectedRect.height),this.selectedBgData=this.ctx.getImageData(0,0,this.width,this.height),t.putImageData(this.selectedImgData,0,0)}this.disx=this.endPoints.x-this.selectedRect.x,this.disy=this.endPoints.y-this.selectedRect.y,this.isDragingSelectRect=!0,this.ctx.drawImage(this.offscreenCanvas,this.selectedRect.x-1,this.selectedRect.y-1)}else this.showLastHistory(),0==this.selectRectAnimateId&&(this.selectRectAnimateId=requestAnimationFrame(this.dashedRectAnimate)),this.selectedImgData=null,this.selectedRect={x:0,y:0,width:0,height:0},this.selectedBgData=this.ctx.getImageData(0,0,this.width,this.height),this.isDrawing=!0}},handlePointerMove(t){this.ctx.fillStyle=this.currentColor,this.ctx.strokeStyle=this.currentColor;const e=this.getPoint({x:t.clientX,y:t.clientY});this.isDrawing?1==this.tool?(this.drawLine(this.endPoints,e),this.endPoints=e):2==this.tool?this.clearPixel(e):3==this.tool?(this.showLastHistory(),this.drawLine(this.endPoints,e)):4==this.tool?(this.showLastHistory(),this.drawRect(this.endPoints,e)):5==this.tool?(this.showLastHistory(),this.drawPixelEllipse(this.endPoints,e)):7==this.tool&&(this.showLastHistory(),this.select(this.endPoints,e)):7==this.tool&&this.isDragingSelectRect?(this.selectedRect.x=e.x-this.disx,this.selectedRect.y=e.y-this.disy):this.tool<6&&(this.showLastHistory(),this.overMove(e))},select(t,e){const i=Math.min(t.x,e.x),s=Math.min(t.y,e.y),o=Math.abs(e.x-t.x)+this.gridSize,r=Math.abs(e.y-t.y)+this.gridSize;this.imgPointList=[[]],this.selectedRect={x:i,y:s,width:o,height:r}},drawDashedRect(){this.ctx.lineDashOffset=(this.ctx.lineDashOffset+1)%100,this.ctx.setLineDash([0]),this.ctx.strokeStyle="#fff",this.ctx.strokeRect(this.selectedRect.x-5,this.selectedRect.y-5,this.selectedRect.width+10,this.selectedRect.height+10),this.ctx.setLineDash([50]),this.ctx.strokeStyle="#000",this.ctx.strokeRect(this.selectedRect.x-5,this.selectedRect.y-5,this.selectedRect.width+10,this.selectedRect.height+10),this.ctx.fillStyle="rgba(0,0,0,0.3)",this.ctx.fillRect(this.selectedRect.x,this.selectedRect.y,this.selectedRect.width,this.selectedRect.height),this.ctx.fillStyle=this.currentColor},dashedRectAnimate(){this.ctx.putImageData(this.selectedBgData,0,0),this.selectedRect.width*this.selectedRect.height!=0&&this.drawDashedRect(),this.selectedImgData&&this.ctx.drawImage(this.offscreenCanvas,this.selectedRect.x,this.selectedRect.y),this.selectRectAnimateId=requestAnimationFrame(this.dashedRectAnimate)},selectSave(){this.ctx.putImageData(this.selectedBgData,0,0),this.ctx.drawImage(this.offscreenCanvas,0,0,this.selectedRect.width,this.selectedRect.height,this.selectedRect.x,this.selectedRect.y,this.selectedRect.width,this.selectedRect.height),this.addHistory()},handlePointerUp(){this.isDrawing&&(this.isDrawing=!1,7==this.tool?this.selectedRect.width*this.selectedRect.height==0&&(cancelAnimationFrame(this.selectRectAnimateId),this.selectRectAnimateId=0,this.selectedRect={x:0,y:0,width:0,height:0},this.selectedImgData=null):this.addHistory()),this.isDragingSelectRect&&(this.isDragingSelectRect=!1,this.selectSave())},drawPixel(t,e=this.penSize,i=this.currentColor){this.ctx.fillStyle=i;const s=t.x/this.gridSize-Math.floor(e/2),o=t.y/this.gridSize-Math.floor(e/2);this.ctx.fillRect(this.gridSize*s,this.gridSize*o,this.gridSize*e,this.gridSize*e)},overMove(t){this.ctx.fillStyle="rgba(0,0,0,0.3)";const e=this.penSize,i=t.x/this.gridSize-Math.floor(e/2),s=t.y/this.gridSize-Math.floor(e/2);this.ctx.fillRect(this.gridSize*i,this.gridSize*s,this.gridSize*e,this.gridSize*e)},clearPixel(t){const e=this.penSize,i=t.x/this.gridSize-Math.floor(e/2),s=t.y/this.gridSize-Math.floor(e/2);this.ctx.clearRect(this.gridSize*i,this.gridSize*s,this.gridSize*e,this.gridSize*e)},drawLine(t,e){let i=t.x,s=t.y,o=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),n=t.x<e.x?this.gridSize:-this.gridSize,a=t.y<e.y?this.gridSize:-this.gridSize,h=o-r;while(1){if(this.drawPixel({x:i,y:s}),i===e.x&&s===e.y)break;let t=2*h;t>-r&&(h-=r,i+=n),t<o&&(h+=o,s+=a)}},drawRect(t,e){let i,s;if(this.shiftdown){const i=e.x-t.x,s=e.y-t.y,o=Math.min(Math.abs(i),Math.abs(s));e=i>0&&s>0?{x:t.x+o,y:t.y+o}:i>0&&s<0?{x:t.x+o,y:t.y-o}:i<0&&s>0?{x:t.x-o,y:t.y+o}:{x:t.x-o,y:t.y-o}}i={x:e.x,y:t.y},s={x:t.x,y:e.y},this.drawLine(t,i),this.drawLine(s,e),this.drawLine(t,s),this.drawLine(i,e)},drawPixelEllipse(t,e){const i=(t.x+e.x)/2/this.gridSize+.5,s=Math.abs((e.x-t.x)/this.gridSize/2),o=e.y>t.y?s:-s,r=this.shiftdown?t.y/this.gridSize+o+.5:(t.y+e.y)/2/this.gridSize+.5,n=this.shiftdown?s:Math.abs((e.y-t.y)/this.gridSize/2);let a=s%1?.5:0,h=n,l=Math.ceil(n*n-s*s*n+.25*s*s),c=2*n*n*a,d=2*s*s*h;this.drawEllipsePoints(i,r,a,h);while(c<d)a++,c+=2*n*n,l<=0?l+=c+n*n:(h--,d-=2*s*s,l+=c-d+n*n),this.drawEllipsePoints(i,r,a,h);let g=Math.ceil(n*n*(a+.5)*(a+.5)+s*s*(h-1)*(h-1)-s*s*n*n);while(h>0)h--,d-=2*s*s,g<=0?(a++,c+=2*n*n,g+=n*n-d+c):g+=s*s-d,this.drawEllipsePoints(i,r,a,h)},drawEllipsePoints(t,e,i,s){t-=.5,e-=.5,this.drawPixel({x:(t+i)*this.gridSize,y:(e-s)*this.gridSize}),this.drawPixel({x:(t-i)*this.gridSize,y:(e-s)*this.gridSize}),this.drawPixel({x:(t-i)*this.gridSize,y:(e+s)*this.gridSize}),this.drawPixel({x:(t+i)*this.gridSize,y:(e+s)*this.gridSize})},fillArea(t){const e=this.getColorAtPixel(t),i=this.hexToArgb(this.ctx.fillStyle);if(this.colorsMatch(e,i))return;const s=[t],{width:o,height:r}=this.$refs.canvas,n=new Set,a=(t,e)=>`${t},${e}`;while(s.length){const{x:t,y:i}=s.pop(),h=this.getColorAtPixel({x:t,y:i});!n.has(a(t,i))&&this.colorsMatch(h,e)&&(this.drawPixel({x:t,y:i},1),n.add(a(t,i)),t>0&&s.push({x:t-this.gridSize,y:i}),t<o-this.gridSize&&s.push({x:t+this.gridSize,y:i}),i>0&&s.push({x:t,y:i-this.gridSize}),i<r-this.gridSize&&s.push({x:t,y:i+this.gridSize}))}},getColorAtPixel(t){const{data:e}=this.ctx.getImageData(t.x,t.y,1,1);return e.slice(0,4)},hexToArgb(t){"#"===t[0]&&(t=t.slice(1));const e=parseInt(t,16);return 8===t.length?[e>>24&255,e>>16&255,e>>8&255,255&e]:6===t.length?[255,e>>16&255,e>>8&255,255&e]:4===t.length?[e>>12&255,e>>8&255,e>>4&255,255&e]:3===t.length?[255,e>>8&255,e>>4&255,255&e]:[0,0,0,0]},colorsMatch(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},clearAll(){this.selectedRect={x:0,y:0,width:0,height:0},this.selectedImgData=null,this.ctx.clearRect(0,0,this.width,this.height),cancelAnimationFrame(this.selectRectAnimateId),this.selectRectAnimateId=0,this.addHistory()},isRectEqual(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},getPoint(t){const e=this.scaleCount/100,i=this.$refs.canvas.getBoundingClientRect(),s=Math.floor((t.x-i.left)/this.gridSize/e)*this.gridSize,o=Math.floor((t.y-i.top)/this.gridSize/e)*this.gridSize;return this.coordinate=`x:${s/this.gridSize},y:${o/this.gridSize}`,{x:s,y:o}},showLastHistory(){const t=this.historys,e=t[t.length-1]["data"];this.ctx.putImageData(e,0,0)},addHistory(){this.historys.push({data:this.ctx.getImageData(0,0,this.width,this.height)}),this.updateOverview(),this.gifImageDataList.length>0&&this.updateGifImage(this.gifImageDataIndex)},undo(){var t=this.historys;t&&t.length>1&&(t.pop(),this.showLastHistory(),this.updateOverview()),this.selectedImgData=null,this.selectedRect={x:0,y:0,width:0,height:0},cancelAnimationFrame(this.selectRectAnimateId),this.selectRectAnimateId=0},getPixelVector(t){const e=this.outputSize,i=`rgba(${t.r},${t.g},${t.b},${t.a})`,s={x:t.x,y:t.y},o={x:t.x+e,y:t.y},r={x:t.x+e,y:t.y+e},n={x:t.x,y:t.y+e},a=(t,e)=>t+e*this.cols;return[[a(s.x,s.y),a(o.x,o.y),i],[a(o.x,o.y),a(r.x,r.y),i],[a(r.x,r.y),a(n.x,n.y),i],[a(n.x,n.y),a(s.x,s.y),i]]},getpathContent(t){let e=[],i=new Map;t.forEach((t=>{const e=this.getPixelVector(t);e.forEach((t=>{if(i.has(t[0]))if(i.has(t[1])){let s=i.get(t[1]),o=null;for(var e=0;e<s.length;e++)if(s[e][0]==t[0]&&s[e][1]==t[2]){o=s.splice(e,1),s.length>0?i.set(t[1],s):i.delete(t[1]);break}if(null==o){let e=i.get(t[0]).push([t[1],t[2]]);i[(t[0],e)]}}else{let e=i.get(t[0]).push([t[1],t[2]]);i[(t[0],e)]}else i.set(t[0],[[t[1],t[2]]])}))}));const s=(t,o=null,r=null)=>{if(i.has(t)){let a=i.get(t);if(null==r){let e=a.splice(0,1)[0];i.set(t,a),a.length<=0&&i.delete(t),o=[t,e[0]],s(e[0],o,e[1])}else{let a=i.get(t),h=null;for(var n=0;n<a.length;n++)if(a[n][1]==r){h=a.splice(n,1)[0],i.set(t,a),a.length<=0&&i.delete(t);break}if(h)o.push(h[0]),s(h[0],o,h[1]);else{if(o.push(r),e.push(o),!(i.size>0))return;{const t=i.keys().next().value,e=i.get(t)[0];s(e[0])}}}}else if(r){if(o.push(r),e.push(o),!(i.size>0))return;{const t=i.keys().next().value,e=i.get(t)[0];s(e[0])}}},o=i.keys().next().value;s(o);let r="",n=new Map;const a=t=>{const e=t%(30*this.cols);return{x:e,y:Math.floor((t-e)/this.cols)}};for(var[h,l]of(e.forEach((t=>{let e=a(t[0]),i={direction:"M",step:0},s=`M${e.x} ${e.y}`;for(var o=1;o<t.length-1;o++){let r=a(t[o]);e.x==r.x?"v"==i.direction?i.step+=r.y-e.y:(0!=i.step&&(s+=`${i.direction}${i.step}`),i.direction="v",i.step=r.y-e.y):"h"==i.direction?i.step+=r.x-e.x:(0!=i.step&&(s+=`${i.direction}${i.step}`),i.direction="h",i.step=r.x-e.x),e.x=r.x,e.y=r.y}s+="z";const r=t[t.length-1];if(n.has(r)){let t=n.get(r);t.push(s),n.set(r,t)}else n.set(r,[s])})),n)){let t='<path d="';l.forEach((e=>{t+=e})),t+=`" fill="${"rgba(0,0,0,255)"==h||"rgba(0,0,1,255)"==h?"currentColor":h}"/>`,r+=t}return console.log(r),r},getSvgContent(t=!1){const e=this.width,i=this.height,s=this.ctx.getImageData(0,0,e,i),o=s.data;let r=[];for(let a=0;a<i;a+=this.gridSize)for(let t=0;t<e;t+=this.gridSize){const i=4*(a*e+t),s=o[i],n=o[i+1],h=o[i+2],l=o[i+3];l>0&&r.push({x:t/this.gridSize*this.outputSize,y:a/this.gridSize*this.outputSize,r:s,g:n,b:h,a:l})}let n=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${this.cols*this.outputSize} ${this.rows*this.outputSize}">`;return n+=this.getpathContent(r),n+="</svg>",n},copySvgCode(){const t=this.getSvgContent();this.copyToClipboard(t)},saveAsSvg(){const t=this.getSvgContent(),e=new Blob([t],{type:"image/svg+xml"}),i=URL.createObjectURL(e),s=document.createElement("a");s.href=i,s.download="drawing.svg",s.click(),URL.revokeObjectURL(i)},saveAsPng(){const t=document.createElement("a"),e=this.maincanvas.toDataURL("image/png");t.href=e,t.download="drawing.png",t.click(),URL.revokeObjectURL(e)},saveAsGif(){if(-1==this.gifImageDataIndex)return void this.$toast.show("没有创建gif图片数据序列","error");const t=this.gifImageDataList,e=new(q())({workers:2,quality:10,workerScript:"augest/js/gifjs/gif.worker.js",transparent:"rgba(0,0,0,0)"});console.log(e),t.forEach((t=>{e.addFrame(t,{delay:Math.floor(this.animateSpeed)})})),e.on("finished",(function(t){const e=URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="output.gif",i.click(),URL.revokeObjectURL(e)})),e.render()},async copyToClipboard(t){try{await navigator.clipboard.writeText(t),this.$toast.show("复制成功","success")}catch(e){this.$toast.show(e,"error")}},dragViewportDown(t){this.$refs.realViewport.removeEventListener("scroll",this.viewportScroll),this.viewport=this.$refs.viewport,this.disx=t.pageX-this.viewport.offsetLeft,this.disy=t.pageY-this.viewport.offsetTop,this.resizeViewport()},dragViewportMove(t){if(this.viewport){const s=this.$refs.canvas_overview,o=this.$refs.realViewport,r=s.clientWidth/this.maincanvas.clientWidth;var e=t.pageX-this.disx,i=t.pageY-this.disy;const n=s.offsetLeft+s.clientWidth-this.viewport.clientWidth-2,a=s.offsetTop+this.viewport.parentElement.clientHeight-this.viewport.clientHeight-2;e=Math.max(s.offsetLeft,Math.min(e,n)),i=Math.max(s.offsetTop,Math.min(i,a)),this.viewport.style.left=e+"px",this.viewport.style.top=i+"px",this.log=`${s.offsetLeft}`;const h=(e-s.offsetLeft)/r,l=(i-s.offsetTop)/r;o.scrollTop=l,o.scrollLeft=h}},dragViewportUp(){this.$refs.realViewport.addEventListener("scroll",this.viewportScroll),this.viewport&&(this.viewport=null)},viewportScroll(){this.log=`${this.$refs.realViewport.scrollTop},${this.$refs.realViewport.scrollLeft}`,this.resizeViewport()},zoomWheel(t){t.preventDefault();const e=t.deltaY;if(e<0){var i=Number(this.scaleCount)+1;this.scaleCount=Math.min(i,100)}else{i=Number(this.scaleCount)-1;this.scaleCount=Math.max(i,10)}this.resizeViewport()},zoomIn(){var t=Number(this.scaleCount)+10;this.scaleCount=Math.min(t,100),this.resizeViewport()},zoomOut(){var t=Number(this.scaleCount)-10;this.scaleCount=Math.max(t,10),this.resizeViewport()},zoomFit(){this.getMinScale(),this.scaleCount=this.minScaleCount,this.resizeViewport()},resizeViewport(){const t=this.$refs.canvas_overview,e=this.$refs.realViewport,i=t.clientWidth/this.maincanvas.clientWidth;this.$nextTick((()=>{const s=e.clientWidth*i,o=e.clientHeight*i;this.$refs.viewport.style.width=`${Math.floor(Math.min(s,t.clientWidth))}px`,this.$refs.viewport.style.height=`${Math.floor(Math.min(o,t.clientHeight)-1)}px`;const r=this.$refs.canvas_overview.offsetTop+this.$refs.realViewport.scrollTop*i,n=this.$refs.canvas_overview.offsetLeft+this.$refs.realViewport.scrollLeft*i;this.$refs.viewport.style.top=`${r}px`,this.$refs.viewport.style.left=`${n}px`}))},pushGifImgList(){const t=this.ctx.getImageData(0,0,this.width,this.height);this.gifImageDataList.splice(this.gifImageDataIndex,0,t),this.gifImageDataIndex++;const e=this;this.$nextTick((()=>{for(var t=e.gifImageDataList.length-1;t>e.gifImageDataIndex;t--){const i=e.$refs.gifCanvas[t],s=e.$refs.gifCanvas[t-1],o=i.getContext("2d");o.clearRect(0,0,100*e.cols/e.rows,100),o.drawImage(s,0,0)}const i=e.$refs.gifCanvas[e.gifImageDataIndex],s=i.getContext("2d");s.clearRect(0,0,100*e.cols/e.rows,100),s.drawImage(e.maincanvas,0,0,e.width,e.height,0,0,100*e.cols/e.rows,100)}))},deleteGifImgList(){for(var t=this.gifImageDataIndex;t<this.gifImageDataList.length-1;t++){const e=this.$refs.gifCanvas[t],i=this.$refs.gifCanvas[t+1],s=e.getContext("2d");s.clearRect(0,0,100*this.cols/this.rows,100),s.drawImage(i,0,0)}this.gifImageDataList.splice(this.gifImageDataIndex,1),this.gifImageDataIndex>=this.gifImageDataList.length?this.gifImageDataIndex=this.gifImageDataList.length-1:this.gifImageDataList.length<1&&(this.gifImageDataIndex=-1)},startAnimate(){0==this.animateId&&this.gifImageDataList.length>0&&(this.animateStartTime=(new Date).getTime(),this.animateId=requestAnimationFrame(this.updateMainCanvasAnimate))},stopAnimate(){cancelAnimationFrame(this.animateId),this.animateId=0},updateMainCanvasAnimate(){this.ctx.clearRect(0,0,this.width,this.height);const t=this.gifImageDataList[this.gifImageDataIndex];this.ctx.putImageData(t,0,0);const e=(new Date).getTime(),i=e-this.animateStartTime;i>this.animateSpeed&&(this.animateStartTime=e,this.gifImageDataIndex=(this.gifImageDataIndex+1)%this.gifImageDataList.length),this.animateId=requestAnimationFrame(this.updateMainCanvasAnimate)},putGifImage2MainCanvas(t){this.stopAnimate(),this.gifImageDataIndex=t;const e=this.gifImageDataList[this.gifImageDataIndex];this.ctx.putImageData(e,0,0),this.addHistory()},updateGifImage(t){const e=this.ctx.getImageData(0,0,this.width,this.height);this.gifImageDataList[t]=e;const i=this;this.$nextTick((()=>{const e=i.$refs.gifCanvas[t],s=e.getContext("2d");s.clearRect(0,0,100*this.cols/this.rows,100),s.drawImage(i.maincanvas,0,0,this.width,this.height,0,0,100*this.cols/this.rows,100)}))},changeSpeed(t){this.animateFpsIndex=(this.animateFpsIndex+t<0?5:this.animateFpsIndex+t)%6,this.animateSpeed=1e3/this.animateFps[this.animateFpsIndex]},async saveGifNPngToFolder(t){if(t.length<1)return void this.$toast.show("没有可以导出的帧","error");const e=t=>new Promise((e=>{const i=document.createElement("canvas");i.width=t.width,i.height=t.height;const s=i.getContext("2d");s.putImageData(t,0,0),i.toBlob((t=>{e(t)}))}));try{const i=await window.showDirectoryPicker();for(let s=0;s<t.length;s++){const o=t[s],r=await e(o),n=`image_${s+1}.png`,a=await i.getFileHandle(n,{create:!0}),h=await a.createWritable();await h.write(r),await h.close()}console.log("图片已保存到文件夹中")}catch(i){console.error("保存图片时出错：",i)}},openFileInput(){document.getElementById("fileInput").click()},importImg(){const t=event.target.files[0],e=this;if(t&&t.type.startsWith("image/")){const i=new FileReader;i.onload=function(t){const i=new Image;i.src=t.target.result,i.onload=function(){e.selectedImgData=null,e.selectedRect={x:0,y:0,width:0,height:0},e.selectedBgData=e.ctx.getImageData(0,0,e.width,e.height),e.offscreenCanvas=document.createElement("canvas");const t=Math.floor(e.height/e.gridSize)*e.gridSize,s=Math.floor(e.height/i.height*i.width/e.gridSize)*e.gridSize;e.offscreenCanvas.width=s,e.offscreenCanvas.height=t;const o=e.offscreenCanvas.getContext("2d");o.drawImage(i,0,0,i.width,i.height,0,0,s,t),e.selectedImgData=o.getImageData(0,0,s,t),0==e.selectRectAnimateId&&(e.selectRectAnimateId=requestAnimationFrame(e.dashedRectAnimate)),e.selectedRect={x:0,y:0,width:s,height:t},e.tool=7}},i.readAsDataURL(t)}else alert("请选择一个有效的图像文件。")},imgToPixel(){if(this.offscreenCanvas){const t=this.offscreenCanvas.width,e=this.offscreenCanvas.height,i=this.offscreenCanvas.getContext("2d"),s=i.getImageData(0,0,t,e),o=s.data;let r=0,n=0,a=0,h=0,l=0;for(let c=0;c<e;c+=this.gridSize)for(let e=0;e<t;e+=this.gridSize){for(let i=0;i<this.gridSize;i++)for(let s=0;s<this.gridSize;s++){const d=4*((c+i)*t+e+s);r+=o[d],n+=o[d+1],a+=o[d+2],h+=o[d+3],l++}r=Math.floor(r/l),n=Math.floor(n/l),a=Math.floor(a/l),h=Math.floor(h/l),i.clearRect(e,c,this.gridSize,this.gridSize),i.fillStyle=`rgba(${r},${n},${a},${h})`,i.fillRect(e,c,this.gridSize,this.gridSize);const s=Math.floor(c/this.gridSize),d=Math.floor(e/this.gridSize);this.imgPointList[s]||(this.imgPointList[s]=[]),this.imgPointList[s][d]=[r,n,a,h],r=0,n=0,a=0,h=0,l=0}}},adjustImg(){if(this.offscreenCanvas){const i=this.offscreenCanvas.getContext("2d"),s=this.processColors();for(var t=0;t<s.length;t++)for(var e=0;e<s[t].length;e++){const[o,r,n,a]=s[t][e];i.fillStyle=`rgba(${o},${r},${n},${a})`,i.fillRect(e*this.gridSize,t*this.gridSize,this.gridSize,this.gridSize)}}},processColors(t=this.imgPointList,e=this.threshold){const i=[],s=(t,e)=>{const[i,s,o,r]=t,[n,a,h,l]=e;return Math.sqrt(Math.pow(i-n,2)+Math.pow(s-a,2)+Math.pow(o-h,2)+Math.pow(255*r-255*l,2))},o=(t,e)=>{const[i,s,o,r]=t,[n,a,h,l]=e;return[Math.round((i+n)/2),Math.round((s+a)/2),Math.round((o+h)/2),Math.round((r+l)/2)]};console.log(t);const r=t.length,n=t[0].length,a=JSON.parse(JSON.stringify(t));for(let h=0;h<r;h++)for(let r=0;r<n;r++){const n=t[h][r];let l=!1;for(let t=0;t<i.length;t++){const c=i[t];if(s(c,n)<e){const e=o(c,n);a[h][r]=t,console.log(a[h][r]),i[t]=e,console.log(`find:${l}`),l=t;break}}console.log(l),0==l&&(a[h][r]=i.length,i.push(n))}console.log(i),console.log(a);for(let h=0;h<r;h++)for(let t=0;t<n;t++)a[h][t]=i[a[h][t]];return a}}},J=i(8998);const Q=(0,J.Z)(Z,[["render",G],["__scopeId","data-v-5c46f14d"]]);var tt=Q}}]);
//# sourceMappingURL=918.c938642d.js.map