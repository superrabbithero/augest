"use strict";(self["webpackChunkaugest"]=self["webpackChunkaugest"]||[]).push([[2054],{32054:function(s,l,n){n.r(l),n.d(l,{default:function(){return r}});var a=n(19812),t=(0,a._)("html",null,[(0,a._)("head"),(0,a._)("body",null,[(0,a._)("h2",null,[(0,a._)("strong",null,"前言")]),(0,a._)("p",null,"之前将博客部署到github Pages是另外起了一个仓库，每次改动之后部署都需要手动build之后再push dist文件夹。之后发现了可以再代码仓库里配置action，就能做到每次push新代码后都能自动打包部署非常方便。"),(0,a._)("h2",null,[(0,a._)("strong",null,"改造开始")]),(0,a._)("h3",null,[(0,a.Uk)("1."),(0,a._)("strong",null,"配置Github Pages")]),(0,a._)("ol",null,[(0,a._)("li",null,[(0,a.Uk)("创建一个新的分支用于部署(网上一般都新建"),(0,a._)("code",null,"gh-pages"),(0,a.Uk)("分支)。")]),(0,a._)("li",null,[(0,a.Uk)("配置仓库的Pages,把source设置为"),(0,a._)("code",null,"GitHub Actions"),(0,a.Uk)("或者"),(0,a._)("code",null,"gh-pages"),(0,a.Uk)("分支。")])]),(0,a._)("h3",null,[(0,a.Uk)("2."),(0,a._)("strong",null,"创建GitHub Actions配置文件")]),(0,a._)("ol",null,[(0,a._)("li",null,[(0,a.Uk)("在项目根目录下创建 "),(0,a._)("code",null,".github/workflows/deploy.yml"),(0,a.Uk)(" 文件。")]),(0,a._)("li",null,[(0,a.Uk)("添加以下内容（适用于 Vue 项目）："),(0,a._)("pre",null,[(0,a._)("code",{"v-pre":"",class:"language-yaml"},[(0,a._)("span",{class:"hljs-comment"},"# .github/workflows/auto-deploy.yml"),(0,a.Uk)("\n\n "),(0,a._)("span",{class:"hljs-attr"},"name:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"auto"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"deploy"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"🚀"),(0,a.Uk)("\n\n "),(0,a._)("span",{class:"hljs-attr"},"on:"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-comment"},"# 监听push操作"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-attr"},"push:"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-attr"},"branches:"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-bullet"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"main"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-comment"},"# 这里只配置了main分支，所以只有推送main分支才会触发以下任务"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-attr"},"pull_request:"),(0,a.Uk)("\n\n "),(0,a._)("span",{class:"hljs-comment"},"# 这个选项可以使你手动在 Action tab 页面触发工作流"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-comment"},"# workflow_dispatch:"),(0,a.Uk)("\n\n "),(0,a._)("span",{class:"hljs-attr"},"permissions:"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-comment"},"# 允许对仓库的内容进行写操作。包括创建、修改和删除文件、目录以及提交更改等"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-comment"},"# 这里只配置了push，所以只有推送main分支才会触发以下任务 "),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-attr"},"contents:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"write"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-comment"},"# 允许管理 GitHub Pages 服务并对其进行写操作"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-attr"},"pages:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"write"),(0,a.Uk)("\n\n\n "),(0,a._)("span",{class:"hljs-attr"},"jobs:"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-comment"},"# 任务ID"),(0,a.Uk)("\n "),(0,a._)("span",{class:"hljs-attr"},"build-and-deploy:"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-comment"},"# 运行环境"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-comment"},"# runs-on: macos-latest"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-comment"},"# runs-on: windows-latest"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-attr"},"runs-on:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"ubuntu-latest"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-attr"},"concurrency:"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-attr"},"group:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"${{"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"github.workflow"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"}}-${{"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"github.ref"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"}}"),(0,a.Uk)("\n     \n     "),(0,a._)("span",{class:"hljs-comment"},"# 步骤"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-attr"},"steps:"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-comment"},"# 官方action，将代码拉取到虚拟机"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-bullet"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-attr"},"name:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"Checkout"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"uses:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"actions/checkout@v3"),(0,a.Uk)("\n\n     "),(0,a._)("span",{class:"hljs-comment"},"# 建一个名为setup-node的步骤（安装指定版本的Node.js）"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-bullet"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-attr"},"name:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"setup-node"),(0,a.Uk)(" \n         "),(0,a._)("span",{class:"hljs-comment"},"# 使用setup-node@v3这个action"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"uses:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"actions/setup-node@v3"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-comment"},"# 指定某个action 可能需要输入的参数"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"with:"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"node-version:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"'20.x'"),(0,a.Uk)("\n\n     "),(0,a._)("span",{class:"hljs-comment"},"# 安装 pnpm"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-bullet"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-attr"},"name:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"Install"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"yarn"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"run:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"npm"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"install"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"yarn"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"-g"),(0,a.Uk)("\n\n     "),(0,a._)("span",{class:"hljs-comment"},"# 安装依赖  "),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-bullet"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-attr"},"name:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"Install"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"dependencies"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"run:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"yarn"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"install"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-comment"},"# 打包"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-bullet"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-attr"},"name:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"Build"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"application"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"🔧"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"run:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"npm"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"run"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"build"),(0,a.Uk)("\n\n     "),(0,a._)("span",{class:"hljs-comment"},"# 部署 https://github.com/JamesIves/github-pages-deploy-action"),(0,a.Uk)("\n     "),(0,a._)("span",{class:"hljs-bullet"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-attr"},"name:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"Deploy"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"🚀"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"uses:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"JamesIves/github-pages-deploy-action@v4"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"if:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"github.ref"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"=="),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"'refs/heads/main'"),(0,a.Uk)("\n         "),(0,a._)("span",{class:"hljs-attr"},"with:"),(0,a.Uk)("\n             "),(0,a._)("span",{class:"hljs-attr"},"token:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"${{"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"secrets.GITHUB_TOKEN"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"}}"),(0,a.Uk)("\n             "),(0,a._)("span",{class:"hljs-attr"},"branch:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"gh-pages"),(0,a.Uk)("  "),(0,a._)("span",{class:"hljs-comment"},"# default: gh-pages"),(0,a.Uk)("\n             "),(0,a._)("span",{class:"hljs-attr"},"folder:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"dist"),(0,a.Uk)("\n             "),(0,a._)("span",{class:"hljs-attr"},"clean:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-literal"},"true"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-comment"},"# Automatically remove deleted files from the deploy branch"),(0,a.Uk)("\n             "),(0,a._)("span",{class:"hljs-comment"},"# commit-message: ${{ github.event.head_commit.message }} # default: `Deploying to gh-pages from @ 3238feb 🚀`"),(0,a.Uk)("\n             "),(0,a._)("span",{class:"hljs-comment"},'# commit-message: "deploy: ${{ github.sha }} (${{ github.event.head_commit.message }}) 🚀 "'),(0,a.Uk)("\n")])])])]),(0,a._)("h3",null,[(0,a.Uk)("3. "),(0,a._)("strong",null,"确保项目结构正确")]),(0,a._)("ol",null,[(0,a._)("li",null,[(0,a._)("p",null,[(0,a._)("strong",null,[(0,a.Uk)("设置 "),(0,a._)("code",null,"vue.config.js")]),(0,a.Uk)(": 如果项目存放在一个子路径下，例如 "),(0,a._)("code",null,"https://username.github.io/repo-name/"),(0,a.Uk)("，需要设置 "),(0,a._)("code",null,"publicPath"),(0,a.Uk)("：")]),(0,a._)("pre",null,[(0,a._)("code",{"v-pre":"",class:"language-javascript"},[(0,a._)("span",{class:"hljs-variable language_"},"module"),(0,a.Uk)("."),(0,a._)("span",{class:"hljs-property"},"exports"),(0,a.Uk)(" = {\n  "),(0,a._)("span",{class:"hljs-attr"},"publicPath"),(0,a.Uk)(": process."),(0,a._)("span",{class:"hljs-property"},"env"),(0,a.Uk)("."),(0,a._)("span",{class:"hljs-property"},"NODE_ENV"),(0,a.Uk)(" === "),(0,a._)("span",{class:"hljs-string"},"'production'"),(0,a.Uk)(" ? "),(0,a._)("span",{class:"hljs-string"},"'/repo-name/'"),(0,a.Uk)(" : "),(0,a._)("span",{class:"hljs-string"},"'/'"),(0,a.Uk)(",\n};\n")])]),(0,a._)("p",null,[(0,a.Uk)("如果是主路径 "),(0,a._)("code",null,"https://username.github.io/"),(0,a.Uk)("，设置为：")]),(0,a._)("pre",null,[(0,a._)("code",{"v-pre":"",class:"language-javascript"},[(0,a._)("span",{class:"hljs-variable language_"},"module"),(0,a.Uk)("."),(0,a._)("span",{class:"hljs-property"},"exports"),(0,a.Uk)(" = {\n  "),(0,a._)("span",{class:"hljs-attr"},"publicPath"),(0,a.Uk)(": "),(0,a._)("span",{class:"hljs-string"},"'/'"),(0,a.Uk)(",\n};\n")])])])]),(0,a._)("h3",null,[(0,a.Uk)("4. "),(0,a._)("strong",null,"提交代码并触发部署")]),(0,a._)("ol",null,[(0,a._)("li",null,[(0,a._)("p",null,[(0,a.Uk)("提交代码到 "),(0,a._)("code",null,"main"),(0,a.Uk)(" 分支：")]),(0,a._)("pre",null,[(0,a._)("code",{"v-pre":"",class:"language-bash"},[(0,a.Uk)("git add .\ngit commit -m "),(0,a._)("span",{class:"hljs-string"},'"Set up GitHub Actions for deployment"'),(0,a.Uk)("\ngit push origin main\n")])])]),(0,a._)("li",null,[(0,a._)("p",null,"Actions 会自动触发部署流程。")])]),(0,a._)("h3",null,[(0,a.Uk)("5. "),(0,a._)("strong",null,"查看部署结果")]),(0,a._)("ol",null,[(0,a._)("li",null,"等待 Actions 执行完成，确保没有错误。"),(0,a._)("li",null,[(0,a.Uk)("打开 GitHub Pages 的 URL 查看结果，例如："),(0,a._)("pre",null,[(0,a._)("code",{"v-pre":""},"https://username.github.io/repo-name/\n")])])]),(0,a._)("h3",null,"注意事项"),(0,a._)("ol",null,[(0,a._)("li",null,[(0,a.Uk)("如果项目路径不正确，检查 "),(0,a._)("code",null,"vue.config.js"),(0,a.Uk)(" 中的 "),(0,a._)("code",null,"publicPath"),(0,a.Uk)(" 配置。")]),(0,a._)("li",null,[(0,a.Uk)("默认情况下，"),(0,a._)("code",null,"GitHub_TOKEN"),(0,a.Uk)(" 有权限推送到仓库。如果需要自定义权限，可以创建个人访问令牌（PAT）并添加到仓库 "),(0,a._)("code",null,"Settings > Secrets and variables > Actions"),(0,a.Uk)(" 中，命名为 "),(0,a._)("code",null,"GH_TOKEN"),(0,a.Uk)("，然后修改配置："),(0,a._)("pre",null,[(0,a._)("code",{"v-pre":"",class:"language-yaml"},[(0,a._)("span",{class:"hljs-attr"},"with:"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"hljs-attr"},"token:"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"${{"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"secrets.GH_TOKEN"),(0,a.Uk)(),(0,a._)("span",{class:"hljs-string"},"}}"),(0,a.Uk)("\n")])])])])])],-1),c=[t];function e(s,l){return(0,a.wg)(),(0,a.iD)("section",null,c)}var p=n(48998);const _={},h=(0,p.Z)(_,[["render",e]]);var r=h}}]);
//# sourceMappingURL=2054-legacy.cc2d0d0f.js.map