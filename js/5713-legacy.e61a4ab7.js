"use strict";(self["webpackChunkaugest"]=self["webpackChunkaugest"]||[]).push([[5713],{54986:function(t,e,n){var i=n(88113);t.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(i)},76650:function(t,e,n){var i=n(1702),o=n(17466),s=n(41340),a=n(38415),r=n(84488),l=i(a),u=i("".slice),c=Math.ceil,h=function(t){return function(e,n,i){var a,h,d=s(r(e)),p=o(n),m=d.length,v=void 0===i?" ":s(i);return p<=m||""==v?d:(a=p-m,h=l(v,c(a/v.length)),h.length>a&&(h=u(h,0,a)),t?d+h:h+d)}};t.exports={start:h(!1),end:h(!0)}},83112:function(t,e,n){var i=n(82109),o=n(76650).start,s=n(54986);i({target:"String",proto:!0,forced:s},{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},6338:function(t,e,n){n.d(e,{Z:function(){return L}});var i=n(19812),o=n(44220),s=n(55893),a=function(t){return(0,i.dD)("data-v-eebb7ae8"),t=t(),(0,i.Cn)(),t},r=a((function(){return(0,i._)("div",{class:"divider-line"},null,-1)})),l={class:"tools-setting-container"},u={class:"content-items"},c=a((function(){return(0,i._)("label",null,"画笔大小：",-1)})),h={class:"content-items"},d=a((function(){return(0,i._)("label",null,"橡皮大小：",-1)})),p={class:"content-items"},m=a((function(){return(0,i._)("label",null,"画笔颜色：",-1)})),v=["onClick"],f={class:"content-items"},g=a((function(){return(0,i._)("label",null,"仅触控笔：",-1)}));function T(t,e,n,a,T,w){var x=(0,i.up)("svg-icon"),y=(0,i.up)("au-slider"),b=(0,i.up)("au-switch"),_=(0,i.up)("my-model");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.wy)((0,i._)("canvas",{ref:"canvas",onPointerdown:e[0]||(e[0]=function(){return w.handlePointerDown&&w.handlePointerDown.apply(w,arguments)}),onPointermove:e[1]||(e[1]=function(){return w.handlePointerMove&&w.handlePointerMove.apply(w,arguments)}),onPointerup:e[2]||(e[2]=function(){return w.handlePointerUp&&w.handlePointerUp.apply(w,arguments)})},null,544),[[o.F8,n.show]]),(0,i.wy)((0,i._)("div",{class:(0,s.C_)({"edit-tools-box":!0,active:T.editToolsActive||T.modal_show.setting_show}),ref:"dragToolsBar",onPointerover:e[8]||(e[8]=function(){return w.handleToolsBarFocus&&w.handleToolsBarFocus.apply(w,arguments)}),onPointerleave:e[9]||(e[9]=function(){return w.handleToolsBarOut&&w.handleToolsBarOut.apply(w,arguments)})},[(0,i._)("div",{class:(0,s.C_)({"edit-tools-item":!0,active:!T.erasing}),onClick:e[3]||(e[3]=function(t){return w.getcanvastool("pencil")})},[(0,i.Wm)(x,{name:"pencilStub01",size:"20"})],2),(0,i._)("div",{class:(0,s.C_)({"edit-tools-item":!0,active:T.erasing}),onClick:e[4]||(e[4]=function(t){return w.getcanvastool("eraser")})},[(0,i.Wm)(x,{name:"eraser02",size:"20"})],2),r,(0,i._)("div",{class:"edit-tools-item",onClick:e[5]||(e[5]=function(t){return T.modal_show.setting_show=!T.modal_show.setting_show})},[(0,i.Wm)(x,{name:"setting02",size:"20"})]),(0,i._)("div",{class:"edit-tools-drag",onPointerdown:e[6]||(e[6]=function(t){return w.dragdown(t)}),onMouseup:e[7]||(e[7]=function(){return w.dragup&&w.dragup.apply(w,arguments)})},[(0,i.Wm)(x,{style:{"user-select":"none"},name:"drag01",size:"20"})],32)],34),[[o.F8,n.show]]),(0,i.Wm)(_,{show:n.show&&T.modal_show.setting_show,modeless:!0,modalKey:"setting_show"},{default:(0,i.w5)((function(){return[(0,i._)("div",l,[(0,i._)("div",u,[c,(0,i.Wm)(y,{modelValue:T.penWidth,"onUpdate:modelValue":e[10]||(e[10]=function(t){return T.penWidth=t}),style:{width:"150px"},max:20},null,8,["modelValue"]),(0,i.Uk)(" "+(0,s.zw)(T.penWidth),1)]),(0,i._)("div",h,[d,(0,i.Wm)(y,{modelValue:T.eraserWidth,"onUpdate:modelValue":e[11]||(e[11]=function(t){return T.eraserWidth=t}),style:{width:"150px"}},null,8,["modelValue"]),(0,i.Uk)((0,s.zw)(T.eraserWidth),1)]),(0,i._)("div",p,[m,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(T.colorList,(function(t){return(0,i.wg)(),(0,i.iD)("div",{onClick:function(e){return T.penColor=t},class:"color-item",style:(0,s.j5)({backgroundColor:t,height:t==T.penColor?"20px":"15px"})},null,12,v)})),256))]),(0,i._)("div",f,[g,(0,i.Wm)(b,{modelValue:T.mode,"onUpdate:modelValue":e[12]||(e[12]=function(t){return T.mode=t})},null,8,["modelValue"]),(0,i.Uk)(" "+(0,s.zw)(T.mode?"开":"关"),1)])])]})),_:1},8,["show"])],64)}var w=n(78255),x=(n(9653),n(57658),n(47941),n(47042),n(140)),y=n(66769),b={props:{show:{type:Boolean,required:!0,default:!1},width:Number,height:Number,switch:Number},components:{auSlider:x.Z,auSwitch:y.Z},watch:{switch:function(t,e){this.changeCanvas(t,e),console.log(t,e)},show:function(t,e){t?(this.resize(),document.body.classList.add("none-select")):document.body.classList.remove("none-select")}},data:function(){var t;return t={log:"",mode:!1,isDrawing:!1,drawData:null,isScroll:0,context:null,currentPointerType:null,multiLastPt:{},offsetTop:0,offsetLeft:0},(0,w.Z)(t,"isScroll",!1),(0,w.Z)(t,"startY",0),(0,w.Z)(t,"scrolltop",0),(0,w.Z)(t,"editTools_show",!1),(0,w.Z)(t,"erasing",!1),(0,w.Z)(t,"el",null),(0,w.Z)(t,"points",[]),(0,w.Z)(t,"beginPoint",{x:0,y:0}),(0,w.Z)(t,"penWidth",5),(0,w.Z)(t,"eraserWidth",40),(0,w.Z)(t,"penColor","#f00"),(0,w.Z)(t,"canvasWidth",0),(0,w.Z)(t,"canvasHeight",0),(0,w.Z)(t,"imgDataList",[]),(0,w.Z)(t,"modal_show",{setting_show:!1}),(0,w.Z)(t,"colorList",["#000","#f00","#ffa500","#ff0","#90ee90","#87ceeb","#fff"]),(0,w.Z)(t,"dragToolsBar",null),(0,w.Z)(t,"disx",0),(0,w.Z)(t,"disy",0),(0,w.Z)(t,"editToolsActive",!1),(0,w.Z)(t,"pressTimer",null),(0,w.Z)(t,"pressTimerNum",0),t},mounted:function(){this.init()},beforeUnmount:function(){document.body.classList.remove("none-select"),document.removeEventListener("pointermove",this.dragmove),document.removeEventListener("pointerup",this.dragup)},methods:{dragdown:function(t){this.dragToolsBar||(this.dragToolsBar=this.$refs.dragToolsBar,document.addEventListener("pointermove",this.dragmove),document.addEventListener("pointerup",this.dragup),this.disx=t.pageX-this.dragToolsBar.offsetLeft,this.disy=t.pageY-this.dragToolsBar.offsetTop,this.dragToolsBar.style.right="unset",this.dragToolsBar.style.left=t.pageX-this.disx+"px",this.dragToolsBar.style.top=t.pageY-this.disy+"px")},dragmove:function(t){this.dragToolsBar&&(this.dragToolsBar.style.left=t.pageX-this.disx+"px",this.dragToolsBar.style.top=t.pageY-this.disy+"px")},dragup:function(){this.dragToolsBar=null,document.removeEventListener("pointermove",this.dragmove)},resize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.$refs.canvas,n=null;n=null==t?this.context.getImageData(0,0,e.width,e.height):t;var i=this.context.strokeStyle,o=this.context.fillStyle,s=this.context.lineWidth,a=this.context.font,r=this.context.textAlign,l=this.context.textBaseline,u=this.context.globalCompositeOperation;e.width=this.el.clientWidth,e.height=this.el.clientHeight,this.canvasWidth=e.width,this.canvasHeight=e.height,this.context.clearRect(0,0,e.width,e.height),this.context.strokeStyle=i,this.context.fillStyle=o,this.context.lineWidth=s,this.context.font=a,this.context.textAlign=r,this.context.textBaseline=l,this.context.globalCompositeOperation=u,""!=n&&this.context.putImageData(n,0,0)},init:function(){window.PointerEvent&&(this.log="Pointer events are supported.");var t=this.$refs.canvas,e=t.parentElement;t.width=e.clientWidth,t.height=e.clientHeight,this.canvasWidth=t.width,this.canvasHeight=t.height,this.el=e,this.offsetLeft=e.offsetLeft,this.offsetTop=e.offsetTop,this.context=t.getContext("2d"),this.context.strokeStyle=this.penColor},switchmode:function(){1==this.mode?this.mode=!1:this.mode=!0},handlePointerDown:function(t){if(!this.dragToolsBar){this.currentPointerType=t.pointerType,0==this.mode&&"pen"==this.currentPointerType&&(this.mode=!0,this.$toast.show('检测到正在使用触控笔，开启"仅触控笔"模式，可在画板设置中关闭',"info"));var e=t.pointerId;this.multiLastPt[e]={x:t.pageX,y:t.pageY},1==this.mode&&"pen"===this.currentPointerType?(this.scrolltop=this.el.parentElement.scrollTop,this.isDrawing=!0,this.points=[],this.points.push({x:t.pageX,y:t.pageY}),this.beginPoint=this.points[0]):1==this.mode&&"touch"===this.currentPointerType?(this.isScroll=e,this.startY=t.pageY,this.scrolltop=this.el.parentElement.scrollTop):!1===this.mode&&(this.scrolltop=this.el.parentElement.scrollTop,2==Object.keys(this.multiLastPt).length?(this.isDrawing=!1,this.isScroll=e,this.startY=t.pageY):1==Object.keys(this.multiLastPt).length&&(this.isDrawing=!0,this.points=[],this.points.push({x:t.pageX,y:t.pageY}),this.beginPoint=this.points[0]))}},drawLine:function(t,e,n,i,o){this.context.beginPath(),this.context.moveTo(t.x-i,t.y-o),this.context.quadraticCurveTo(e.x-i,e.y-o,n.x-i,n.y-o),this.context.strokeStyle=this.penColor,this.context.lineCap="round",this.context.stroke(),this.context.closePath()},handlePointerMove:function(t){if(!this.dragToolsBar){var e=t.pointerId;if(this.isDrawing&&this.multiLastPt[e]){if(1==this.mode&&"pen"===this.currentPointerType||!1===this.mode){var n=this.el.parentElement.scrollTop;this.erasing?this.context.lineWidth=this.eraserWidth:"pen"==this.currentPointerType?this.context.lineWidth=t.pressure*this.penWidth:this.context.lineWidth=this.penWidth;var i={x:t.pageX,y:t.pageY};if(this.points.push(i),this.points.length>2){var o=this.points.slice(-2),s=o[0],a={x:(o[0].x+o[1].x)/2,y:(o[0].y+o[1].y)/2},r=this.offsetTop-n;this.drawLine(this.beginPoint,s,a,this.offsetLeft,r),this.beginPoint=a}}}else if(this.isScroll==e){var l=t.pageY-this.startY;this.el.parentElement.scrollTop=this.scrolltop-l}}},handlePointerUp:function(t){if(!this.dragToolsBar){var e=t.pointerId;this.isDrawing&&(this.isDrawing=!1),this.multiLastPt[e]&&delete this.multiLastPt[e],this.isScroll&&(this.isScroll=null)}},getcanvastool:function(t){console.log("click");this.context;"pencil"==t?(this.context.globalCompositeOperation="source-over",this.erasing=!1):"eraser"==t&&(this.context.globalCompositeOperation="destination-out",this.erasing=!0)},handleToolsBarFocus:function(){console.log("---------focus"),this.editToolsActive=!0,this.pressTimerNum=0,clearInterval(this.pressTimer),this.pressTimer=null},handleToolsBarOut:function(){var t=this;this.pressTimerNum=0,clearInterval(this.pressTimer),this.pressTimer=null,this.pressTimer=setInterval((function(){t.pressTimerNum+=1,t.pressTimerNum>=5&&(t.editToolsActive=!1,t.pressTimerNum=0,clearInterval(t.pressTimer),t.pressTimer=null)}),1e3)},changeCanvas:function(t,e){var n=this.$refs.canvas,i=this.context.getImageData(0,0,n.width,n.height);this.imgDataList[e]=i,i=this.imgDataList[t]?this.imgDataList[t]:"";var o=this;this.$parent.$nextTick((function(){o.resize(i)}))}}},_=n(48998);const P=(0,_.Z)(b,[["render",T],["__scopeId","data-v-eebb7ae8"]]);var L=P},64626:function(t,e,n){n.d(e,{Z:function(){return u}});var i=n(19812),o=n(55893);function s(t,e,n,s,a,r){return(0,i.wg)(),(0,i.iD)("div",null,(0,o.zw)(a.timer),1)}n(83112),n(92222);var a={data:function(){return{startTime:0,elapsedTime:0,timerInterval:null,timer:"00:00:00",status:0}},unmounted:function(){clearInterval(this.timerInterval)},methods:{startTimer:function(){1!=this.status&&(clearInterval(this.timerInterval),console.log("start"),this.startTime=Date.now()-this.elapsedTime,this.timerInterval=setInterval(this.updateTimer,1e3),this.status=1)},resetTimer:function(){0!=this.status&&(clearInterval(this.timerInterval),this.timerInterval=null,this.elapsedTime=0,this.$parent.timer="00:00:00",this.timer="00:00:00",this.status=0)},pause:function(){1==this.status&&(clearInterval(this.timerInterval),this.status=2)},updateTimer:function(){this.elapsedTime=Date.now()-this.startTime;var t=new Date(this.elapsedTime),e=String(t.getUTCHours()).padStart(2,"0"),n=String(t.getUTCMinutes()).padStart(2,"0"),i=String(t.getUTCSeconds()).padStart(2,"0");this.timer="".concat(e,":").concat(n,":").concat(i),this.$parent.timer=this.timer}}},r=n(48998);const l=(0,r.Z)(a,[["render",s],["__scopeId","data-v-03acfd1c"]]);var u=l},140:function(t,e,n){n.d(e,{Z:function(){return d}});var i=n(19812),o=n(55893),s={class:"au-slider-container"},a={class:"au-slider-track",ref:"track"};function r(t,e,n,r,l,u){return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("div",{class:"au-slider-track-box",onPointerdown:e[0]||(e[0]=function(){return r.handleTrackStart&&r.handleTrackStart.apply(r,arguments)})},[(0,i._)("div",a,[(0,i._)("div",{class:"au-slider-runnable-track",ref:"runnable",style:(0,o.j5)({width:"".concat(r.progress,"%")})},null,4)],512)],32),(0,i._)("div",{class:"au-slider-thumb",ref:"thumb",style:(0,o.j5)({left:"".concat(r.progress,"%")}),onPointerdown:e[1]||(e[1]=function(){return r.handleThumbStart&&r.handleThumbStart.apply(r,arguments)})},null,36)])}n(9653),n(92222);var l=n(20521),u={props:{modelValue:{type:Number,required:!0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},vertical:{type:Boolean,default:!1}},setup:function(t,e){var n=e.emit,o=(0,l.iH)(null),s=(0,l.iH)(null),a=!1,r=(0,l.iH)(null),u=(0,l.iH)(0),c=(0,l.iH)(0),h=(0,l.iH)(t.modelValue);console.log("setup:".concat(h.value));var d=(0,l.iH)(0),p=(0,l.iH)(0),m=(0,i.Fl)((function(){return(t.modelValue-t.min)/(t.max-t.min)*100}));(0,i.bv)((function(){o.value=document.querySelector(".au-slider-track"),d.value=o.value.clientWidth/t.max*t.step,console.log("onMounted:".concat(h.value))})),(0,i.Jd)((function(){document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",T)}));var v=function(t){t.preventDefault(),a||(a=!0,u.value=t.pageX-s.value.offsetLeft,c.value=t.pageY-s.value.offsetTop,document.addEventListener("pointermove",g),document.addEventListener("pointerup",T))},f=function(e){if(console.log("handleTrackStart-1:".concat(h.value)),!a){a=!0,console.log("left_steped = Math.floor(".concat(e.offsetX,"/").concat(d.value,")*").concat(d.value));var i=Math.floor(e.offsetX/d.value)*d.value;console.log("left_steped:".concat(i));var o=Math.min(Math.max(i,0),s.value.parentElement.clientWidth);console.log("handleTrackStart-2:".concat(h.value)),console.log("Math.ceil(".concat(t.min," + ").concat(o,"/").concat(d.value,")*").concat(t.step,";")),h.value=Math.ceil(t.min+o/d.value)*t.step,console.log("handleTrackStart-3:".concat(h.value)),p.value=o,n("update:modelValue",h.value),u.value=e.pageX-s.value.offsetLeft,c.value=e.pageY-s.value.offsetTop,document.addEventListener("pointermove",g),document.addEventListener("pointerup",T)}},g=function(e){if(e.preventDefault(),a)if(t.vertical){var i=Math.min(Math.max(e.pageY-c.value,0),s.value.parentElement.clientHeight);r.value.style.height="".concat(i,"px"),s.value.style.top="".concat(i,"px")}else{var o=Math.floor((e.pageX-u.value)/d.value)*d.value,l=Math.min(Math.max(o,0),s.value.parentElement.clientWidth);p.value=l,h.value=Math.ceil(t.min+l/d.value)*t.step,n("update:modelValue",h.value)}},T=function t(){a=!1,document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",t)};return{progress:m,thumb:s,runnable:r,modelValue:h,handleTrackStart:f,handleThumbStart:v,leftValue:p}}},c=n(48998);const h=(0,c.Z)(u,[["render",r],["__scopeId","data-v-6c5f8db9"]]);var d=h},66769:function(t,e,n){n.d(e,{Z:function(){return d}});var i=n(19812),o=n(55893),s=function(t){return(0,i.dD)("data-v-30c23a8c"),t=t(),(0,i.Cn)(),t},a=s((function(){return(0,i._)("div",{class:"switch-handle"},null,-1)})),r=[a];function l(t,e,n,s,a,l){return(0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(["switch ".concat(n.size),{"switch-on":n.modelValue}]),onClick:e[0]||(e[0]=function(){return l.toggle&&l.toggle.apply(l,arguments)})},r,2)}var u={name:"Switch",props:{modelValue:{type:Boolean,default:!1},size:{tpye:String,default:"normal"}},emits:["update:modelValue"],methods:{toggle:function(){this.$emit("update:modelValue",!this.modelValue)}}},c=n(48998);const h=(0,c.Z)(u,[["render",l],["__scopeId","data-v-30c23a8c"]]);var d=h}}]);
//# sourceMappingURL=5713-legacy.e61a4ab7.js.map