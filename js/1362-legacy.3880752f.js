"use strict";(self["webpackChunkaugest"]=self["webpackChunkaugest"]||[]).push([[1362],{89988:function(t,e,i){i.d(e,{Z:function(){return E}});var n=i(19812),s=i(44220),o=i(55893),l=i.p+"img/pen.fe268fe1.png",r=i.p+"img/eraser.5178d610.png",a=function(t){return(0,n.dD)("data-v-679dd5f0"),t=t(),(0,n.Cn)(),t},h={src:l},c={src:r},u={class:"edit-tools"},d={class:"edit-tools-group"},p=a((function(){return(0,n._)("img",{draggable:"false",src:l},null,-1)})),m=[p],g=a((function(){return(0,n._)("img",{draggable:"false",src:r},null,-1)})),f=[g],v=a((function(){return(0,n._)("svg",{fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},[(0,n._)("path",{d:"M15 1v6H9V1h6zm-2 2h-2v2h2V3zm2 6v6H9V9h6zm-2 2h-2v2h2v-2zm2 6v6H9v-6h6zm-2 2h-2v2h2v-2z",fill:"currentColor"})],-1)})),w=[v],x={class:"edit-tools-box"},y=a((function(){return(0,n._)("div",{class:"divider-line"},null,-1)})),T={class:"edit-tools-item"},_={class:"content-items"},P=a((function(){return(0,n._)("label",null,"画笔大小：",-1)})),C={class:"content-items"},b=a((function(){return(0,n._)("label",null,"橡皮大小：",-1)})),W={class:"content-items"},D=a((function(){return(0,n._)("label",null,"画笔颜色：",-1)})),k=["onClick"],S={class:"content-items"},I=a((function(){return(0,n._)("label",null,"仅触控笔：",-1)}));function L(t,e,i,l,r,a){var p=(0,n.up)("svg-icon"),g=(0,n.up)("my-model");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.wy)((0,n._)("canvas",{ref:"canvas",onPointerdown:e[0]||(e[0]=function(){return a.handlePointerDown&&a.handlePointerDown.apply(a,arguments)}),onPointermove:e[1]||(e[1]=function(){return a.handlePointerMove&&a.handlePointerMove.apply(a,arguments)}),onPointerup:e[2]||(e[2]=function(){return a.handlePointerUp&&a.handlePointerUp.apply(a,arguments)})},null,544),[[s.F8,i.show]]),(0,n.wy)((0,n._)("div",{class:(0,o.C_)({"edit-tools-fixedbox":!0,show:r.editTools_show})},[(0,n._)("div",{class:(0,o.C_)({"edit-tools-handle":!0,show:!r.editTools_show}),onPointerdown:e[3]||(e[3]=function(){return a.handleStart&&a.handleStart.apply(a,arguments)}),onPointermove:e[4]||(e[4]=function(){return a.handleMove&&a.handleMove.apply(a,arguments)}),onPointerup:e[5]||(e[5]=function(){return a.handleEnd&&a.handleEnd.apply(a,arguments)}),onPointerleave:e[6]||(e[6]=function(){return a.handleCancel&&a.handleCancel.apply(a,arguments)})},[(0,n.wy)((0,n._)("img",h,null,512),[[s.F8,!r.erasing]]),(0,n.wy)((0,n._)("img",c,null,512),[[s.F8,r.erasing]])],34),(0,n._)("div",u,[(0,n._)("div",{style:{height:"100%","font-size":"18px","line-height":"50px",padding:"0 2px 0 2px",color:"#252525"},onClick:e[7]||(e[7]=function(t){return r.editTools_show=!1})},"×"),(0,n._)("div",d,[(0,n._)("div",{class:(0,o.C_)({"edit-tools-item":!0,active:!r.erasing}),onClick:e[8]||(e[8]=function(t){return a.getcanvastool("pencil")})},m,2),(0,n._)("div",{class:(0,o.C_)({"edit-tools-item":!0,active:r.erasing}),onClick:e[9]||(e[9]=function(t){return a.getcanvastool("eraser")})},f,2)]),(0,n._)("div",{style:{width:"25px",display:"flex",color:"#252525","margin-left":"15px"},onClick:e[10]||(e[10]=function(t){return r.modal_show.setting_show=!0})},w)])],2),[[s.F8,i.show]]),(0,n.wy)((0,n._)("div",x,[(0,n._)("div",{class:(0,o.C_)({"edit-tools-item":!0,active:!r.erasing})},[(0,n.Wm)(p,{name:"pencilStub01",size:"20"})],2),(0,n._)("div",{class:(0,o.C_)({"edit-tools-item":!0,active:r.erasing})},[(0,n.Wm)(p,{name:"eraser02",size:"20"})],2),y,(0,n._)("div",T,[(0,n.Wm)(p,{name:"setting02",size:"20"})])],512),[[s.F8,i.show]]),(0,n.Wm)(g,{show:i.show&&r.modal_show.setting_show,modeless:!0,modalKey:"setting_show"},{default:(0,n.w5)((function(){return[(0,n._)("div",_,[P,(0,n.wy)((0,n._)("input",{type:"range",class:"custom-range","onUpdate:modelValue":e[11]||(e[11]=function(t){return r.penWidth=t}),min:"1",max:"15"},null,512),[[s.nr,r.penWidth]]),(0,n.Uk)(" "+(0,o.zw)(r.penWidth),1)]),(0,n._)("div",C,[b,(0,n.wy)((0,n._)("input",{type:"range",class:"custom-range","onUpdate:modelValue":e[12]||(e[12]=function(t){return r.eraserWidth=t}),min:"5",max:"30"},null,512),[[s.nr,r.eraserWidth]]),(0,n.Uk)(" "+(0,o.zw)(r.eraserWidth),1)]),(0,n._)("div",W,[D,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.colorList,(function(t){return(0,n.wg)(),(0,n.iD)("div",{onClick:function(e){return r.penColor=t},class:"color-item",style:(0,o.j5)({backgroundColor:t,height:t==r.penColor?"20px":"15px"})},null,12,k)})),256))]),(0,n._)("div",S,[I,(0,n._)("div",{onClick:e[13]||(e[13]=function(t){return a.switchmode()}),class:(0,o.C_)({"switch-botton":!0,close:"all touch"==r.mode})},null,2),(0,n.Uk)(" "+(0,o.zw)("only pen"==r.mode?"开":"关"),1)])]})),_:1},8,["show"])],64)}var Z=i(78255),z=(i(9653),i(57658),i(47941),i(47042),{props:{show:{type:Boolean,required:!0,default:!1},width:Number,height:Number,switch:Number},watch:{switch:function(t,e){this.changeCanvas(t,e),console.log(t,e)},show:function(t,e){t?(this.resize(),document.body.classList.add("none-select")):document.body.classList.remove("none-select")}},data:function(){var t;return t={log:"",mode:"all touch",isDrawing:!1,drawData:null,isScroll:0,context:null,currentPointerType:null,multiLastPt:{},offsetTop:0,offsetLeft:0},(0,Z.Z)(t,"isScroll",!1),(0,Z.Z)(t,"startY",0),(0,Z.Z)(t,"scrolltop",0),(0,Z.Z)(t,"editTools_show",!1),(0,Z.Z)(t,"erasing",!1),(0,Z.Z)(t,"el",null),(0,Z.Z)(t,"points",[]),(0,Z.Z)(t,"beginPoint",{x:0,y:0}),(0,Z.Z)(t,"penWidth",5),(0,Z.Z)(t,"eraserWidth",10),(0,Z.Z)(t,"penColor","#f00"),(0,Z.Z)(t,"canvasWidth",0),(0,Z.Z)(t,"canvasHeight",0),(0,Z.Z)(t,"pressTimer",null),(0,Z.Z)(t,"imgDataList",[]),(0,Z.Z)(t,"modal_show",{setting_show:!1}),(0,Z.Z)(t,"colorList",["#000","#f00","#ffa500","#ff0","#90ee90","#87ceeb","#fff"]),t},mounted:function(){this.init()},beforeUnmount:function(){document.body.classList.remove("none-select")},methods:{changePenWidth:function(){var t=document.getElementById("penWidth-range");this.penWidth=parseInt(t.value)},resize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.$refs.canvas,i=null;i=null==t?this.context.getImageData(0,0,e.width,e.height):t;var n=this.context.strokeStyle,s=this.context.fillStyle,o=this.context.lineWidth,l=this.context.font,r=this.context.textAlign,a=this.context.textBaseline,h=this.context.globalCompositeOperation;e.width=this.el.clientWidth,e.height=this.el.clientHeight,this.canvasWidth=e.width,this.canvasHeight=e.height,this.context.clearRect(0,0,e.width,e.height),this.context.strokeStyle=n,this.context.fillStyle=s,this.context.lineWidth=o,this.context.font=l,this.context.textAlign=r,this.context.textBaseline=a,this.context.globalCompositeOperation=h,""!=i&&this.context.putImageData(i,0,0)},init:function(){window.PointerEvent&&(this.log="Pointer events are supported.");var t=this.$refs.canvas,e=t.parentElement;t.width=e.clientWidth,t.height=e.clientHeight,this.canvasWidth=t.width,this.canvasHeight=t.height,this.el=e,this.offsetLeft=e.offsetLeft,this.offsetTop=e.offsetTop,this.context=t.getContext("2d"),this.context.strokeStyle=this.penColor},switchmode:function(){"only pen"==this.mode?this.mode="all touch":this.mode="only pen"},handlePointerDown:function(t){this.currentPointerType=t.pointerType,"all touch"==this.mode&&"pen"==this.currentPointerType&&(this.mode="only pen",this.$toast.show('检测到正在使用触控笔，开启"仅触控笔"模式，可在画板设置中关闭',"info"));var e=t.pointerId;this.multiLastPt[e]={x:t.pageX,y:t.pageY},"only pen"==this.mode&&"pen"===this.currentPointerType?(this.scrolltop=this.el.parentElement.scrollTop,this.isDrawing=!0,this.points=[],this.points.push({x:t.pageX,y:t.pageY}),this.beginPoint=this.points[0]):"only pen"==this.mode&&"touch"===this.currentPointerType?(this.isScroll=e,this.startY=t.pageY,this.scrolltop=this.el.parentElement.scrollTop):"all touch"===this.mode&&(this.scrolltop=this.el.parentElement.scrollTop,2==Object.keys(this.multiLastPt).length?(this.isDrawing=!1,this.isScroll=e,this.startY=t.pageY):1==Object.keys(this.multiLastPt).length&&(this.isDrawing=!0,this.points=[],this.points.push({x:t.pageX,y:t.pageY}),this.beginPoint=this.points[0]))},drawLine:function(t,e,i,n,s){this.context.beginPath(),this.context.moveTo(t.x-n,t.y-s),this.context.quadraticCurveTo(e.x-n,e.y-s,i.x-n,i.y-s),this.context.strokeStyle=this.penColor,this.context.lineCap="round",this.context.stroke(),this.context.closePath()},handlePointerMove:function(t){var e=t.pointerId;if(this.isDrawing&&this.multiLastPt[e]){if("only pen"==this.mode&&"pen"===this.currentPointerType||"all touch"===this.mode){var i=this.el.parentElement.scrollTop;this.erasing?this.context.lineWidth=this.eraserWidth:"pen"==this.currentPointerType?this.context.lineWidth=t.pressure*this.penWidth:this.context.lineWidth=this.penWidth;var n={x:t.pageX,y:t.pageY};if(this.points.push(n),this.points.length>2){var s=this.points.slice(-2),o=s[0],l={x:(s[0].x+s[1].x)/2,y:(s[0].y+s[1].y)/2},r=this.offsetTop-i;this.drawLine(this.beginPoint,o,l,this.offsetLeft,r),this.beginPoint=l}}}else if(this.isScroll==e){var a=t.pageY-this.startY;this.el.parentElement.scrollTop=this.scrolltop-a}},handlePointerUp:function(t){var e=t.pointerId;this.isDrawing&&(this.isDrawing=!1),this.multiLastPt[e]&&delete this.multiLastPt[e],this.isScroll&&(this.isScroll=null)},getcanvastool:function(t){console.log("click");this.context;"pencil"==t?(this.context.globalCompositeOperation="source-over",this.erasing=!1):"eraser"==t&&(this.context.globalCompositeOperation="destination-out",this.erasing=!0)},handleStart:function(){var t=this;console.log("start"),this.pressTimer=setTimeout((function(){t.modal_show.setting_show=!0,clearTimeout(t.pressTimer),t.pressTimer=null}),500)},handleMove:function(t){this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=null)},handleEnd:function(){console.log("end"),this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=null,this.getcanvastool(this.erasing?"pencil":"eraser"))},handleCancel:function(){this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=null)},changeCanvas:function(t,e){var i=this.$refs.canvas,n=this.context.getImageData(0,0,i.width,i.height);this.imgDataList[e]=n,n=this.imgDataList[t]?this.imgDataList[t]:"";var s=this;this.$parent.$nextTick((function(){s.resize(n)}))}}}),Y=i(48998);const U=(0,Y.Z)(z,[["render",L],["__scopeId","data-v-679dd5f0"]]);var E=U},64626:function(t,e,i){i.d(e,{Z:function(){return h}});var n=i(19812),s=i(55893);function o(t,e,i,o,l,r){return(0,n.wg)(),(0,n.iD)("div",null,(0,s.zw)(l.timer),1)}i(83112),i(92222);var l={data:function(){return{startTime:0,elapsedTime:0,timerInterval:null,timer:"00:00:00",status:0}},unmounted:function(){clearInterval(this.timerInterval)},methods:{startTimer:function(){1!=this.status&&(clearInterval(this.timerInterval),console.log("start"),this.startTime=Date.now()-this.elapsedTime,this.timerInterval=setInterval(this.updateTimer,1e3),this.status=1)},resetTimer:function(){0!=this.status&&(clearInterval(this.timerInterval),this.timerInterval=null,this.elapsedTime=0,this.$parent.timer="00:00:00",this.timer="00:00:00",this.status=0)},pause:function(){1==this.status&&(clearInterval(this.timerInterval),this.status=2)},updateTimer:function(){this.elapsedTime=Date.now()-this.startTime;var t=new Date(this.elapsedTime),e=String(t.getUTCHours()).padStart(2,"0"),i=String(t.getUTCMinutes()).padStart(2,"0"),n=String(t.getUTCSeconds()).padStart(2,"0");this.timer="".concat(e,":").concat(i,":").concat(n),this.$parent.timer=this.timer}}},r=i(48998);const a=(0,r.Z)(l,[["render",o],["__scopeId","data-v-03acfd1c"]]);var h=a}}]);
//# sourceMappingURL=1362-legacy.3880752f.js.map